<!doctype html><html lang=zh-CN data-theme=light><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#19b8eb" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.126.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="软件管理 "><meta itemprop=description content="1208034077#qq.com"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="http://localhost:1313/imgs/hugo_next_avatar.png"><meta itemprop=keywords content="linux"><meta property="og:type" content="article"><meta property="og:title" content="软件管理 "><meta property="og:description" content="1208034077#qq.com"><meta property="og:image" content="/imgs/hugo_next_avatar.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="http://localhost:1313/post/linux12/"><meta property="og:site_name" content="蓝惠の小窝"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="蓝惠の小窝"><meta property="article:published_time" content="2024-12-19 04:06:00 +0800 CST"><meta property="article:modified_time" content="2024-12-19 04:06:00 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.css><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"linux12","permalink":"http://localhost:1313/post/linux12/","title":"软件管理 ","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://hm.baidu.com/hm.js?",e.async="true",document.head.appendChild(e)})</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>软件管理 - 蓝惠の小窝</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>蓝惠の小窝</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>寻找大波斯菊需要的不是金钱，而是一颗去找寻的心♥.</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>友链</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>82</span></a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#软件相关概念>软件相关概念</a><ul><li><a href=#abi>ABI</a></li><li><a href=#api>API</a></li><li><a href=#开发语言>开发语言</a></li><li><a href=#语言程序的实现过程>语言程序的实现过程</a></li><li><a href=#静态链接>静态链接</a></li><li><a href=#动态链接>动态链接</a></li><li><a href=#模块库文件>模块（库）文件</a></li></ul></li><li><a href=#软件包介绍>软件包介绍</a><ul><li><a href=#软件包中的文件分类>软件包中的文件分类</a></li><li><a href=#程序包管理器>程序包管理器</a></li><li><a href=#包命名>包命名</a></li><li><a href=#包的依赖>包的依赖</a></li><li><a href=#程序包管理器相关文件>程序包管理器相关文件</a></li><li><a href=#获取程序包的途径>获取程序包的途径</a><ul><li><a href=#系统发版的光盘或官方网站>系统发版的光盘或官方网站</a></li><li><a href=#第三方组织提供>第三方组织提供</a></li><li><a href=#软件项目官方站点>软件项目官方站点</a></li><li><a href=#搜索引擎>搜索引擎</a></li><li><a href=#自己制作>自己制作</a></li></ul></li><li><a href=#rpm-包管理器--安装>rpm 包管理器 安装</a></li><li><a href=#升级和降级>升级和降级</a></li><li><a href=#包查询>包查询</a></li><li><a href=#包卸载>包卸载</a></li><li><a href=#包校验>包校验</a></li><li><a href=#数据库维护>数据库维护</a></li></ul></li><li><a href=#yum和dnf>yum和dnf</a><ul><li><a href=#yum客户端配置>yum客户端配置</a><ul><li><a href=#yum-源配置过程>yum 源配置过程</a></li></ul></li></ul></li></ul><ul><li><a href=#id--command-line--date-and-time--actions--altered>[root@centos8 ~]#dnf history
ID | Command line | Date and time | Action(s) | Altered</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=蓝惠の小窝 src=/imgs/img-lazy-loading.gif data-src=/imgs/hugo_next_avatar.png><p class=site-author-name itemprop=name>蓝惠の小窝</p><div class=site-description itemprop=description>1208034077#qq.com</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>82</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>7</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>55</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/lanhui672 title="Github → https://github.com/lanhui672" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title></div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=http://lanhui.live title=http://lanhui.live target=_blank>短域密语</a></li><li class=links-of-blogroll-item><a href=http://lan-hui.com title=http://lan-hui.com target=_blank>引导页</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=0001-01-01T00:00:00+00:00></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=171030></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=388></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=2024-12-23T20:06:00+08:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/lanhui672/lanhui672.github.io/wiki rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg>
</a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=http://localhost:1313/post/linux12/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/hugo_next_avatar.png"><meta itemprop=name content="蓝惠の小窝"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="蓝惠の小窝"><meta itemprop=description content="1208034077#qq.com"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="软件管理 "><meta itemprop=description content="软件相关概念 ABI ABI : Application Binary Interface Windows与Linux不兼容 ELF(Executable and Linkable Format) Linux PE（Portable Executable）Windows API API即App"></span><header class=post-header><h1 class=post-title itemprop="name headline">软件管理</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2024-12-19 04:06:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2024-12-19 04:06:00 +0800 CST">2024-12-19
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/linux itemprop=url rel=index><span itemprop=name>linux</span></a></span></span></div><div class=post-meta-items></div></div><meta name=baidu-site-verification content="codeva-CvrLlzui8a"><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?289d43bfba112a047eccf686e7551557",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></header><div class="post-body autonumber" itemprop=articleBody><h2 id=软件相关概念>软件相关概念
<a class=header-anchor href=#%e8%bd%af%e4%bb%b6%e7%9b%b8%e5%85%b3%e6%a6%82%e5%bf%b5></a></h2><h3 id=abi>ABI
<a class=header-anchor href=#abi></a></h3><p>ABI : Application Binary Interface<br>Windows与Linux不兼容<br>ELF(Executable and Linkable Format) Linux
PE（Portable Executable）Windows</p><h3 id=api>API
<a class=header-anchor href=#api></a></h3><p>API即Application Programming Interface，API可以在各种不同的操作系统上实现给应用程序提供完全
相同的接口，而它们本身在这些系统上的实现却可能迥异，主流的操作系统有两种，一种是Windows系
统，另一种是Linux系统。由于操作系统的不同，API又分为Windows API和Linux API。在Windows平
台开发出来的软件在Linux上无法运行，在Linux上开发的软件在Windows上又无法运行，这就导致了软
件移植困难，POSIX 标准的出现就是为了解决这个问题<br>POSIX：Portable Operating System Interface 可移植操作系统接口，定义了操作系统应该为应用程序
提供的接口标准，是IEEE为要在各种UNIX操作系统上运行的软件而定义的一系列API标准的总称。
Linux和windows都要实现基本的posix标准，程序就在源代码级别可移植了</p><h3 id=开发语言>开发语言
<a class=header-anchor href=#%e5%bc%80%e5%8f%91%e8%af%ad%e8%a8%80></a></h3><p>系统级开发
汇编语言
C
C++
应用级开发
java
Python
go
php
perl
delphi
basic
ruby
bash</p><h3 id=语言程序的实现过程>语言程序的实现过程
<a class=header-anchor href=#%e8%af%ad%e8%a8%80%e7%a8%8b%e5%ba%8f%e7%9a%84%e5%ae%9e%e7%8e%b0%e8%bf%87%e7%a8%8b></a></h3><p>C 程序源代码 &ndash;> 预处理 &ndash;> 编译 &ndash;> 汇编 &ndash;> 链接<br>C语言的程序编译主要经过四个过程：<br><img src=/imgs/img-lazy-loading.gif data-src=/images/url/linux/linux09/10.jpg alt></p><ul><li>预处理（Pre-Processing）
1）将所有的#define删除，并且展开所有的宏定义<br>2）处理所有的条件预编译指令，比如#if #ifdef #elif #else #endif等<br>3）处理#include 预编译指令，将被包含的文件插入到该预编译指令的位置。<br>4）删除所有注释 &ldquo;//&ldquo;和&rdquo;/* */&rdquo;.<br>5）添加行号和文件标识，以便编译时产生调试用的行号及编译错误警告行号。<br>6）保留所有的#pragma编译器指令，因为编译器需要使用它们</li><li>编译 （Compiling）
编译过程就是把预处理完的文件进行一系列的词法分析，语法分析，语义分析及优化后，最后生成
相应的汇编代码</li><li>汇编 （Assembling）
汇编器是将汇编代码转变成机器可以执行的命令，每一个汇编语句几乎都对应一条机器指令。汇编
相对于编译过程比较简单，根据汇编指令和机器指令的对照表一一翻译即可</li><li>链接 （Linking）
通过调用链接器ld来链接程序运行需要的一大堆目标文件，以及所依赖的其它库文件，最后生成可
执行文件<br>范例：gcc 编译过程</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#分步骤编译运行
</span></span><span style=display:flex><span>gcc -E hello.c -o hello.i 对hello.c文件进行预处理，生成了hello.i 文件
</span></span><span style=display:flex><span>gcc -S hello.i -o hello.s 对预处理文件进行编译，生成了汇编文件
</span></span><span style=display:flex><span>gcc -c hello.s -o hello.o 对汇编文件进行编译，生成了目标文件
</span></span><span style=display:flex><span>gcc hello.o -o hello       对目标文件进行链接，生成可执行文件
</span></span><span style=display:flex><span>#一步实现编译过程
</span></span><span style=display:flex><span>gcc hello.c -o hello       直接编译链接成可执行目标文件
</span></span></code></pre></div><h3 id=静态链接>静态链接
<a class=header-anchor href=#%e9%9d%99%e6%80%81%e9%93%be%e6%8e%a5></a></h3><ul><li>把程序对应的依赖库复制一份到包</li><li>生成模块文件libxxx.a</li><li>嵌入程序包</li><li>升级难，需重新编译</li><li>占用较多空间，迁移容易</li></ul><h3 id=动态链接>动态链接
<a class=header-anchor href=#%e5%8a%a8%e6%80%81%e9%93%be%e6%8e%a5></a></h3><ul><li>只把依赖加做一个动态链接</li><li>生成模块文件libxxx.so</li><li>连接指向</li><li>占用较少空间，升级方便</li></ul><h3 id=模块库文件>模块（库）文件
<a class=header-anchor href=#%e6%a8%a1%e5%9d%97%e5%ba%93%e6%96%87%e4%bb%b6></a></h3><p>查看二进制程序所依赖的库文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>ldd /PATH/TO/BINARY_FILE
</span></span></code></pre></div><p>管理及查看本机装载的库文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#加载配置文件中指定的库文件
</span></span><span style=display:flex><span>ldconfig
</span></span><span style=display:flex><span>#显示本机已经缓存的所有可用库文件名及文件路径映射关系
</span></span><span style=display:flex><span>/sbin/ldconfig –p
</span></span></code></pre></div><p>配置文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>/etc/ld.so.conf
</span></span><span style=display:flex><span>/etc/ld.so.conf.d/*.conf
</span></span></code></pre></div><p>缓存文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>/etc/ld.so.cache
</span></span></code></pre></div><p>范例：库文件破坏后，将导致依赖的程序无法正常运行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>[root<span style=color:#960050;background-color:#1e0010>@</span>centos8 <span style=color:#f92672>~</span>]<span style=color:#75715e>#ldd /bin/ls</span>
</span></span><span style=display:flex><span>linux<span style=color:#f92672>-</span>vdso<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>1</span> (<span style=color:#ae81ff>0x00007ffc509fd000</span>)
</span></span><span style=display:flex><span>libselinux<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>=&gt;</span> <span style=color:#f92672>/</span>lib64<span style=color:#f92672>/</span>libselinux<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>1</span> (<span style=color:#ae81ff>0x00007fc6ef24a000</span>)
</span></span><span style=display:flex><span>libcap<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>=&gt;</span> <span style=color:#f92672>/</span>lib64<span style=color:#f92672>/</span>libcap<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>2</span> (<span style=color:#ae81ff>0x00007fc6ef044000</span>)
</span></span><span style=display:flex><span>libc<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>6</span> <span style=color:#f92672>=&gt;</span> <span style=color:#f92672>/</span>lib64<span style=color:#f92672>/</span>libc<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>6</span> (<span style=color:#ae81ff>0x00007fc6eec81000</span>)
</span></span><span style=display:flex><span>libpcre2<span style=color:#f92672>-</span><span style=color:#ae81ff>8.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>=&gt;</span> <span style=color:#f92672>/</span>lib64<span style=color:#f92672>/</span>libpcre2<span style=color:#f92672>-</span><span style=color:#ae81ff>8.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>0</span> (<span style=color:#ae81ff>0x00007fc6ee9fd000</span>)
</span></span><span style=display:flex><span>libdl<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>=&gt;</span> <span style=color:#f92672>/</span>lib64<span style=color:#f92672>/</span>libdl<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>2</span> (<span style=color:#ae81ff>0x00007fc6ee7f9000</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>lib64<span style=color:#f92672>/</span>ld<span style=color:#f92672>-</span>linux<span style=color:#f92672>-</span>x86<span style=color:#f92672>-</span><span style=color:#ae81ff>64.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>2</span> (<span style=color:#ae81ff>0x00007fc6ef698000</span>)
</span></span><span style=display:flex><span>libpthread<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>=&gt;</span> <span style=color:#f92672>/</span>lib64<span style=color:#f92672>/</span>libpthread<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>0</span> (<span style=color:#ae81ff>0x00007fc6ee5d9000</span>)
</span></span><span style=display:flex><span>[root<span style=color:#960050;background-color:#1e0010>@</span>centos8 <span style=color:#f92672>~</span>]<span style=color:#75715e>#ldd /bin/cat</span>
</span></span><span style=display:flex><span>linux<span style=color:#f92672>-</span>vdso<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>1</span> (<span style=color:#ae81ff>0x00007ffe335dd000</span>)
</span></span><span style=display:flex><span>libc<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>6</span> <span style=color:#f92672>=&gt;</span> <span style=color:#f92672>/</span>lib64<span style=color:#f92672>/</span>libc<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>6</span> (<span style=color:#ae81ff>0x00007fa34749e000</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>lib64<span style=color:#f92672>/</span>ld<span style=color:#f92672>-</span>linux<span style=color:#f92672>-</span>x86<span style=color:#f92672>-</span><span style=color:#ae81ff>64.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>2</span> (<span style=color:#ae81ff>0x00007fa347a6b000</span>)
</span></span><span style=display:flex><span>[root<span style=color:#960050;background-color:#1e0010>@</span>centos8 <span style=color:#f92672>~</span>]<span style=color:#75715e>#mv /lib64/libc.so.6 /tmp</span>
</span></span><span style=display:flex><span>[root<span style=color:#960050;background-color:#1e0010>@</span>centos8 <span style=color:#f92672>~</span>]<span style=color:#75715e>#ls</span>
</span></span><span style=display:flex><span>ls: error <span style=color:#66d9ef>while</span> loading shared libraries: libc<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>6</span>: cannot open shared object
</span></span><span style=display:flex><span>file: No such file <span style=color:#f92672>or</span> directory
</span></span><span style=display:flex><span>[root<span style=color:#960050;background-color:#1e0010>@</span>centos8 <span style=color:#f92672>~</span>]<span style=color:#75715e>#cat</span>
</span></span><span style=display:flex><span>cat: error <span style=color:#66d9ef>while</span> loading shared libraries: libc<span style=color:#f92672>.</span>so<span style=color:#f92672>.</span><span style=color:#ae81ff>6</span>: cannot open shared object
</span></span><span style=display:flex><span>file: No such file <span style=color:#f92672>or</span> directory
</span></span></code></pre></div><h2 id=软件包介绍>软件包介绍
<a class=header-anchor href=#%e8%bd%af%e4%bb%b6%e5%8c%85%e4%bb%8b%e7%bb%8d></a></h2><p>开源软件最初只提供了打包的源码文件，用户必须自已编译每个想在GNU/Linux上运行的软件。用户急
需系统能提供一种更加便利的方法来管理这些软件，当Debian诞生时，这样一个管理工具dpkg也就应
运而生，可用来管理deb后缀的"包"文件。从而著名的"package"概念第一次出现在GNU/Linux系统中，
稍后Red Hat才开发自己的rpm包管理系统<br>范例: 使用光盘</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#神奇的光盘挂载目录
</span></span><span style=display:flex><span>#CentOS
</span></span><span style=display:flex><span>[root@centos8 ~]#rpm -q autofs || yum -y install autofs
</span></span><span style=display:flex><span>[root@centos8 ~]#systemctl enable --now autofs
</span></span><span style=display:flex><span>#Ubuntu
</span></span><span style=display:flex><span>root@ubuntu2004:~# apt install autofs -y
</span></span><span style=display:flex><span>root@ubuntu2004:~# vim /etc/auto.master
</span></span><span style=display:flex><span>/misc /etc/auto.misc
</span></span><span style=display:flex><span>root@ubuntu2004:~# systemctl restart autofs
</span></span></code></pre></div><h3 id=软件包中的文件分类>软件包中的文件分类
<a class=header-anchor href=#%e8%bd%af%e4%bb%b6%e5%8c%85%e4%b8%ad%e7%9a%84%e6%96%87%e4%bb%b6%e5%88%86%e7%b1%bb></a></h3><ul><li>二进制文件</li><li>库文件</li><li>配置文件</li><li>帮助文件
范例：利用 cpio工具查看包文件列表</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm2cpio 包文件|cpio –itv 预览包内文件
</span></span><span style=display:flex><span>rpm2cpio 包文件|cpio –id &#34;*.conf&#34; 释放包内文件
</span></span></code></pre></div><h3 id=程序包管理器>程序包管理器
<a class=header-anchor href=#%e7%a8%8b%e5%ba%8f%e5%8c%85%e7%ae%a1%e7%90%86%e5%99%a8></a></h3><p>软件包管理器功能：<br>将编译好的应用程序的各组成文件打包一个或几个程序包文件，利用包管理器可以方便快捷地实现程序
包的安装、卸载、查询、升级和校验等管理操作<br>主流的程序包管理器</p><ul><li>redhat：rpm文件, rpm 包管理器，rpm：Redhat Package Manager，RPM Package Manager</li><li>debian：deb文件, dpkg 包管理器</li></ul><h3 id=包命名>包命名
<a class=header-anchor href=#%e5%8c%85%e5%91%bd%e5%90%8d></a></h3><p>源代码打包文件命名：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>name-VERSION.tar.gz|bz2|xz
</span></span><span style=display:flex><span>VERSION: major.minor.release
</span></span></code></pre></div><p>范例:Linux 最新内核的C源码的行数</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>[root@centos8 ~]#tar xvf linux-5.7.2.tar.xz
</span></span><span style=display:flex><span>[root@centos8 ~]#cd linux-5.7.2/
</span></span><span style=display:flex><span>[root@centos8 linux-5.7.2]#for file in `find -name &#34;*.c&#34;`;do line=`cat $file|wc
</span></span><span style=display:flex><span>-l`;let sum+=line;done;echo $sum
</span></span><span style=display:flex><span>19517994
</span></span><span style=display:flex><span>[root@centos8 linux-5.7.2]#cat `find -name &#34;*.c&#34;` |wc -l
</span></span><span style=display:flex><span>19517994
</span></span><span style=display:flex><span>[root@centos8 linux-5.7.2]#find -name &#34;*.c&#34; | xargs cat |wc -l
</span></span><span style=display:flex><span>19517994
</span></span></code></pre></div><p>rpm包命名方式：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>name-VERSION-release.arch.rpm
</span></span><span style=display:flex><span>VERSION: major.minor.release
</span></span><span style=display:flex><span>release：release.OS
</span></span></code></pre></div><p>常见的arch：</p><ul><li>x86: i386, i486, i586, i686</li><li>x86_64: x64, x86_64, amd64</li><li>powerpc: ppc</li><li>跟平台无关：noarch
范例：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>bash-3.2-32.el5_9.1.i386.rpm
</span></span><span style=display:flex><span>bash-4.2.46-19.el7.x86_64.rpm
</span></span><span style=display:flex><span>bash-4.4.19-7.el8.x86_64.rpm
</span></span><span style=display:flex><span>bash-4.4.19-7.el8.aarch64.rpm
</span></span><span style=display:flex><span>bash-4.4.19-7.el8.ppc64le.rpm
</span></span><span style=display:flex><span>bc_1.07.1-2_amd64.deb
</span></span><span style=display:flex><span>bc_1.07.1-2_s390x.deb
</span></span></code></pre></div><p>范例：统计rpm的架构类型及相应的包数量</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>[root@centos8 Packages]#pwd
</span></span><span style=display:flex><span>/misc/cd/BaseOS/Packages
</span></span><span style=display:flex><span>[root@centos8 Packages]#ls *.rpm | grep -Eo &#39;[^.]+\.rpm$&#39;| grep -Eo
</span></span><span style=display:flex><span>&#39;^[^.]+&#39;|sort |uniq -c
</span></span><span style=display:flex><span>389 i686
</span></span><span style=display:flex><span>211 noarch
</span></span><span style=display:flex><span>1061 x86_64
</span></span><span style=display:flex><span>[root@centos8 Packages]#ls *.rpm |rev|cut -d. -f2|rev |sort |uniq -c
</span></span><span style=display:flex><span>389 i686
</span></span><span style=display:flex><span>211 noarch
</span></span><span style=display:flex><span>1061 x86_64
</span></span><span style=display:flex><span>[root@centos8 Packages]#ls *.rpm | grep -Eo &#39;[^.]+\.rpm$&#39;|cut -d. -f1|sort |uniq
</span></span><span style=display:flex><span>-c
</span></span><span style=display:flex><span>389 i686
</span></span><span style=display:flex><span>211 noarch
</span></span><span style=display:flex><span>1061 x86_64
</span></span></code></pre></div><h3 id=包的依赖>包的依赖
<a class=header-anchor href=#%e5%8c%85%e7%9a%84%e4%be%9d%e8%b5%96></a></h3><p>软件包之间可能存在依赖关系，甚至循环依赖，即：A包依赖B包，B包依赖C包，C包依赖A包<br>安装软件包时，会因为缺少依赖的包，而导致安装包失败。<br>解决依赖包管理工具：</p><ul><li>yum：rpm包管理器的前端工具</li><li>dnf：Fedora 18+ rpm包管理器前端管理工具，CentOS 8 版代替 yum</li><li>apt：deb包管理器前端工具</li><li>zypper：suse上的rpm前端管理工具</li></ul><h3 id=程序包管理器相关文件>程序包管理器相关文件
<a class=header-anchor href=#%e7%a8%8b%e5%ba%8f%e5%8c%85%e7%ae%a1%e7%90%86%e5%99%a8%e7%9b%b8%e5%85%b3%e6%96%87%e4%bb%b6></a></h3><ol><li>包文件组成 (每个包独有)</li></ol><ul><li>包内的文件</li><li>元数据，如：包的名称，版本，依赖性，描述等</li><li>可能会有包安装或卸载时运行的脚本</li></ul><ol start=2><li>数据库(公共)：/var/lib/rpm</li></ol><ul><li>程序包名称及版本</li><li>依赖关系</li><li>功能说明</li><li>包安装后生成的各文件路径及校验码信息</li></ul><h3 id=获取程序包的途径>获取程序包的途径
<a class=header-anchor href=#%e8%8e%b7%e5%8f%96%e7%a8%8b%e5%ba%8f%e5%8c%85%e7%9a%84%e9%80%94%e5%be%84></a></h3><p>软件包需要事先将源码进行编译后打包形成，获取包的途径如下：</p><h4 id=系统发版的光盘或官方网站>系统发版的光盘或官方网站
<a class=header-anchor href=#%e7%b3%bb%e7%bb%9f%e5%8f%91%e7%89%88%e7%9a%84%e5%85%89%e7%9b%98%e6%88%96%e5%ae%98%e6%96%b9%e7%bd%91%e7%ab%99></a></h4><p>CentOS 镜像：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>https:<span style=color:#f92672>//</span>www<span style=color:#f92672>.</span>centos<span style=color:#f92672>.</span>org<span style=color:#f92672>/</span>download<span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>http:<span style=color:#f92672>//</span>mirrors<span style=color:#f92672>.</span>aliyun<span style=color:#f92672>.</span>com
</span></span><span style=display:flex><span>https:<span style=color:#f92672>//</span>mirrors<span style=color:#f92672>.</span>huaweicloud<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>https:<span style=color:#f92672>//</span>mirror<span style=color:#f92672>.</span>tuna<span style=color:#f92672>.</span>tsinghua<span style=color:#f92672>.</span>edu<span style=color:#f92672>.</span>cn<span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>http:<span style=color:#f92672>//</span>mirrors<span style=color:#f92672>.</span>sohu<span style=color:#f92672>.</span>com
</span></span><span style=display:flex><span>http:<span style=color:#f92672>//</span>mirrors<span style=color:#f92672>.</span><span style=color:#ae81ff>163.</span>com
</span></span></code></pre></div><p>Ubuntu 镜像：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>http://cdimage.ubuntu.com/releases/
</span></span><span style=display:flex><span>http://releases.ubuntu.com
</span></span></code></pre></div><h4 id=第三方组织提供>第三方组织提供
<a class=header-anchor href=#%e7%ac%ac%e4%b8%89%e6%96%b9%e7%bb%84%e7%bb%87%e6%8f%90%e4%be%9b></a></h4><ul><li>Fedora-EPEL：Extra Packages for Enterprise Linux<br><a href=https://fedoraproject.org/wiki/EPEL title=https://fedoraproject.org/wiki/EPEL rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://fedoraproject.org/wiki/EPEL
<i class="fa fa-external-link-alt"></i></a><br><a href=https://mirrors.aliyun.com/epel/ title=https://mirrors.aliyun.com/epel/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.aliyun.com/epel/
<i class="fa fa-external-link-alt"></i></a><br><a href=https://mirrors.cloud.tencent.com/epel/ title=https://mirrors.cloud.tencent.com/epel/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.cloud.tencent.com/epel/
<i class="fa fa-external-link-alt"></i></a></li><li>SCL： Software Collections，提供较高版本的第三方软件包<br><a href=https://wiki.centos.org/SpecialInterestGroup/SCLo title=https://wiki.centos.org/SpecialInterestGroup/SCLo rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://wiki.centos.org/SpecialInterestGroup/SCLo
<i class="fa fa-external-link-alt"></i></a><br>企业级 Linux 发行版本都被设计成持久可用的。它们的设计亦包括在发行版本使用期内维持 ABI／
API 兼容性，因此只要某个发行版本仍获支持，你在它发行首日所写的程序便可一直运作。现时
CentOS 的寿命是 10 年。然而，这意味著在发行版本使用期的尾段，它所包含的程序语言或数据库版
本（例如 php、python、perl 或 mysql、postgresql）对比新近的Linux 发行版本所提供的就
显得老旧。<br>不过有很多企业亦希望能以较新的程序创建软件。她们想同时拥有稳定性及较新的软件。她们要求这些
软件兼容其它系统软件，好让她们能选择遁序改进或较新的软件作开发之用。<br>软件集Software Collections（SCL）源出现了，以帮助解决 RHEL/CentOS 下的这种问题。SCL
的创建就是为了给 RHEL/CentOS 用户提供一种以方便、安全地安装和使用应用程序和运行时环境的多
个（而且可能是更新的）版本的方式，同时避免把系统搞乱。与之相对的是第三方源，它们可能会在已
安装的包之间引起冲突。比如：SCL 容许你执行 CentOS 提供的缺省 python（这样 yum 及其它
CentOS 工具便可用），又容许你同时安装较新版的 python 作创建及执行程序之用。<br>SoftwareCollections.org 是为 Red Hat Enterprise Linux，Fedora，CentOS 和
Scientific Linux 创建软件集合（SCL）的项目站点</li><li>Community Enterprise Linux Repository：http://www.elrepo.org，支持最新的内核和硬件相关
包</li></ul><h4 id=软件项目官方站点>软件项目官方站点
<a class=header-anchor href=#%e8%bd%af%e4%bb%b6%e9%a1%b9%e7%9b%ae%e5%ae%98%e6%96%b9%e7%ab%99%e7%82%b9></a></h4><p><a href=http://yum.mariadb.org/10.4/centos8-amd64/rpms/ title=http://yum.mariadb.org/10.4/centos8-amd64/rpms/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://yum.mariadb.org/10.4/centos8-amd64/rpms/
<i class="fa fa-external-link-alt"></i></a><br><a href=http://repo.mysql.com/yum/mysql-8.0-community/el/8/x86_64/ title=http://repo.mysql.com/yum/mysql-8.0-community/el/8/x86_64/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://repo.mysql.com/yum/mysql-8.0-community/el/8/x86_64/
<i class="fa fa-external-link-alt"></i></a></p><h4 id=搜索引擎>搜索引擎
<a class=header-anchor href=#%e6%90%9c%e7%b4%a2%e5%bc%95%e6%93%8e></a></h4><p><a href=http://pkgs.org title=http://pkgs.org rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://pkgs.org
<i class="fa fa-external-link-alt"></i></a><br><a href=http://rpmfind.net title=http://rpmfind.net rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://rpmfind.net
<i class="fa fa-external-link-alt"></i></a><br><a href=http://rpm.pbone.net title=http://rpm.pbone.net rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://rpm.pbone.net
<i class="fa fa-external-link-alt"></i></a><br><a href=https://sourceforge.net/ title=https://sourceforge.net/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://sourceforge.net/
<i class="fa fa-external-link-alt"></i></a><br>注意：第三方包建议要检查其合法性，来源合法性,程序包的完整性</p><h4 id=自己制作>自己制作
<a class=header-anchor href=#%e8%87%aa%e5%b7%b1%e5%88%b6%e4%bd%9c></a></h4><p>将源码文件，利用工具，如：rpmbuild，fpm 等工具制作成rpm包文件</p><h3 id=rpm-包管理器--安装>rpm 包管理器 安装
<a class=header-anchor href=#rpm-%e5%8c%85%e7%ae%a1%e7%90%86%e5%99%a8--%e5%ae%89%e8%a3%85></a></h3><p>CentOS 系统上使用rpm命令管理程序包<br>功能：<br>安装、卸载、升级、查询、校验、数据库维护</p><p>格式：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm {-i|--install} [install-options] PACKAGE_FILE…
</span></span></code></pre></div><p>选项：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>-v: verbose
</span></span><span style=display:flex><span>-vv:
</span></span><span style=display:flex><span>-h: 以#显示程序包管理执行进度
</span></span></code></pre></div><p>常用组合：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm -ivh PACKAGE_FILE ...
</span></span></code></pre></div><p>rpm包安装[install-options]<br>不能解决依赖关系问题，基本不用。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>--test: 测试安装，但不真正执行安装，即dry run模式
</span></span><span style=display:flex><span>--nodeps：忽略依赖关系
</span></span><span style=display:flex><span>--replacepkgs | replacefiles
</span></span><span style=display:flex><span>--nosignature: 不检查来源合法性
</span></span><span style=display:flex><span>--nodigest：不检查包完整性
</span></span><span style=display:flex><span>--noscripts：不执行程序包脚本
</span></span><span style=display:flex><span>       %pre: 安装前脚本 --nopre
</span></span><span style=display:flex><span>      %post: 安装后脚本 --nopost
</span></span><span style=display:flex><span>     %preun: 卸载前脚本 --nopreun
</span></span><span style=display:flex><span>    %postun: 卸载后脚本 --nopostun
</span></span></code></pre></div><h3 id=升级和降级>升级和降级
<a class=header-anchor href=#%e5%8d%87%e7%ba%a7%e5%92%8c%e9%99%8d%e7%ba%a7></a></h3><p>rpm包升级</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm {-U|--upgrade} [install-options] PACKAGE_FILE...
</span></span><span style=display:flex><span>rpm {-F|--freshen} [install-options] PACKAGE_FILE...
</span></span></code></pre></div><p>对应选项:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>upgrade：安装有旧版程序包，则&#34;升级&#34;，如果不存在旧版程序包，则&#34;安装&#34;
</span></span><span style=display:flex><span>freshen：安装有旧版程序包，则&#34;升级&#34;， 如果不存在旧版程序包，则不执行升级操作
</span></span><span style=display:flex><span>--oldpackage：降级
</span></span><span style=display:flex><span>--force: 强制安装
</span></span></code></pre></div><p>常用组合</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm -Uvh PACKAGE_FILE ...
</span></span><span style=display:flex><span>rpm -Fvh PACKAGE_FILE ...
</span></span></code></pre></div><p>升级注意项：<br>(1) 不要对内核做升级操作；Linux支持多内核版本并存，因此直接安装新版本内核<br>(2) 如果原程序包的配置文件安装后曾被修改，升级时，新版本提供的同一个配置文件不会直接覆盖老<br>版本的配置文件，而把新版本文件重命名(FILENAME.rpmnew)后保留</p><h3 id=包查询>包查询
<a class=header-anchor href=#%e5%8c%85%e6%9f%a5%e8%af%a2></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm {-q|--query} [select-options] [query-options]
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>[select-options]
</span></span><span style=display:flex><span>-a：所有包  （查询）
</span></span><span style=display:flex><span>-f：查看指定的文件由哪个程序包安装生成（qf）
</span></span><span style=display:flex><span>-p rpmfile：针对尚未安装的程序包文件做查询操作
</span></span><span style=display:flex><span>[query-options]
</span></span><span style=display:flex><span>--changelog：查询rpm包的changelog
</span></span><span style=display:flex><span>-c：查询程序的配置文件
</span></span><span style=display:flex><span>-d：查询程序的文档
</span></span><span style=display:flex><span>-i：information  查看信息
</span></span><span style=display:flex><span>-l：查看指定的程序包安装后生成的所有文件
</span></span><span style=display:flex><span>--scripts：程序包自带的脚本  postinstall 安装后脚本postuninstall 卸载后脚本
</span></span><span style=display:flex><span>--last 最后安装的包
</span></span><span style=display:flex><span>--changelog 安装包的变更历史
</span></span><span style=display:flex><span>#和CAPABILITY相关
</span></span><span style=display:flex><span>--whatprovides CAPABILITY：查询指定的CAPABILITY由哪个包所提供
</span></span><span style=display:flex><span>--whatrequires CAPABILITY：查询指定的CAPABILITY被哪个包所依赖
</span></span><span style=display:flex><span>--provides：列出指定程序包所提供的CAPABILITY
</span></span><span style=display:flex><span>-R,--requires 查询指定的程序包所依赖的CAPABILITY
</span></span></code></pre></div><p>常用查询用法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>-qa         查询所有已安装的软件包。
</span></span><span style=display:flex><span>-q PACKAGE 查询软件包数据库以获取有关软件包的信息
</span></span><span style=display:flex><span>-qi PACKAGE 查询并显示关于已安装软件包的详细信息
</span></span><span style=display:flex><span>-qc PACKAGE  查询（query）已安装的 RPM 软件包中包含的配置文件（configuration files）
</span></span><span style=display:flex><span>-ql PACKAGE   查询某个软件包安装了哪些文件。
</span></span><span style=display:flex><span>-qd PACKAGE   查询（query）已安装的 RPM 软件包中包含的文档文件（documentation files）
</span></span><span style=display:flex><span>-q --scripts PACKAGE
</span></span><span style=display:flex><span>-qf FILE      查询某个文件属于哪个软件包
</span></span><span style=display:flex><span>-qpi PACKAGE_FILE  查询（query）RPM 软件包（package）的详细信息（information），而不需要安装该软件包。这个命令可以帮助你查看一个 RPM 文件的内容，包括它的名称、版本、发行版、架构、描述、安装前的脚本、安装后的脚本、文件列表等信息。
</span></span><span style=display:flex><span>-qpl PACKAGE_FILE, ...  查询（query）RPM 软件包（package）中的文件列表（list），而不需要安装该软件包。这个命令可以帮助你查看一个 RPM 文件中包含的所有文件和目录，以及它们将被安装到系统上的位置。
</span></span></code></pre></div><p>范例: 查看最近安装的包</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>[root<span style=color:#960050;background-color:#1e0010>@</span>rocky <span style=color:#f92672>~</span>]<span style=color:#75715e># rpm -qa --last|head</span>
</span></span><span style=display:flex><span>tar<span style=color:#f92672>-</span><span style=color:#ae81ff>1.34</span><span style=color:#f92672>-</span><span style=color:#ae81ff>7.</span>el9<span style=color:#f92672>.</span>x86_64                         Sun Dec <span style=color:#ae81ff>15</span> <span style=color:#ae81ff>10</span>:<span style=color:#ae81ff>59</span>:<span style=color:#ae81ff>20</span> <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>libcbor<span style=color:#f92672>-</span><span style=color:#ae81ff>0.7</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>6.</span>el8<span style=color:#f92672>.</span>x86_64                    Sat Dec <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>42</span> <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>inih<span style=color:#f92672>-</span><span style=color:#ae81ff>58</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1.</span>el8<span style=color:#f92672>.</span>x86_64                          Sat Dec <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>42</span> <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>ima<span style=color:#f92672>-</span>evm<span style=color:#f92672>-</span>utils<span style=color:#f92672>-</span><span style=color:#ae81ff>1.5</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.</span>el9<span style=color:#f92672>.</span><span style=color:#ae81ff>0.1</span><span style=color:#f92672>.</span>x86_64            Sat Dec <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>42</span> <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>pam<span style=color:#f92672>-</span><span style=color:#ae81ff>1.5</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22.</span>el9_5<span style=color:#f92672>.</span>x86_64                     Sat Dec <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>41</span> <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>kernel<span style=color:#f92672>-</span>tools<span style=color:#f92672>-</span><span style=color:#ae81ff>5.14</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>503.15</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1.</span>el9_5<span style=color:#f92672>.</span>x86_64     Sat Dec <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>39</span> <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>kernel<span style=color:#f92672>-</span><span style=color:#ae81ff>5.14</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>503.15</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1.</span>el9_5<span style=color:#f92672>.</span>x86_64           Sat Dec <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>39</span> <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>epel<span style=color:#f92672>-</span>release<span style=color:#f92672>-</span><span style=color:#ae81ff>9</span><span style=color:#f92672>-</span><span style=color:#ae81ff>7.</span>el9<span style=color:#f92672>.</span>noarch                   Sat Dec <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>39</span> <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>kernel<span style=color:#f92672>-</span>tools<span style=color:#f92672>-</span>libs<span style=color:#f92672>-</span><span style=color:#ae81ff>5.14</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>503.15</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1.</span>el9_5<span style=color:#f92672>.</span>x86_64 Sat Dec <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>38</span> <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>kernel<span style=color:#f92672>-</span>modules<span style=color:#f92672>-</span><span style=color:#ae81ff>5.14</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>503.15</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1.</span>el9_5<span style=color:#f92672>.</span>x86_64   Sat Dec <span style=color:#ae81ff>14</span> <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>22</span> <span style=color:#ae81ff>2024</span>
</span></span></code></pre></div><h3 id=包卸载>包卸载
<a class=header-anchor href=#%e5%8c%85%e5%8d%b8%e8%bd%bd></a></h3><p>格式：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm {-e|--erase} [--allmatches] [--nodeps] [--noscripts] [--notriggers] [--test]
</span></span><span style=display:flex><span>PACKAGE_NAME ...
</span></span></code></pre></div><p>注意：当包卸载时，对应的配置文件不会删除， 以FILENAME.rpmsave形式保留<br>范例：强行删除rpm包，并恢复</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>[root@centos7 ~]#rpm -e rpm --nodeps
</span></span><span style=display:flex><span>#重启进入rescue模式
</span></span><span style=display:flex><span>#mkdir /mnt/cdrom
</span></span><span style=display:flex><span>#mount /dev/sr0 /mnt/cdrom
</span></span><span style=display:flex><span>#rpm -ivh /mnt/cdrom/Packages/rpm-4.11.3-40.el7.x86_64.rpm --root=/mnt/sysimage
</span></span><span style=display:flex><span>#reboot
</span></span></code></pre></div><h3 id=包校验>包校验
<a class=header-anchor href=#%e5%8c%85%e6%a0%a1%e9%aa%8c></a></h3><p>在安装包时，系统也会检查包的来源是否是合法的<br>检查包的完整性和签名</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm -K|--checksig rpmfile
</span></span></code></pre></div><p>在检查包的来源和完整性前，必须导入所需要公钥<br>范例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7
</span></span><span style=display:flex><span>rpm -qa &#34;gpg-pubkey*&#34;
</span></span></code></pre></div><p>范例：CentOS 8</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>[root@centos8 ~]#rpm -K /misc/cd/AppStream/Packages/httpd-2.4.37-
</span></span><span style=display:flex><span>16.module_el8.1.0+256+ae790463.x86_64.rpm
</span></span><span style=display:flex><span>/misc/cd/AppStream/Packages/httpd-2.4.37-
</span></span><span style=display:flex><span>16.module_el8.1.0+256+ae790463.x86_64.rpm: digests SIGNATURES NOT OK
</span></span><span style=display:flex><span>[root@centos8 ~]#cat /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
</span></span><span style=display:flex><span>-----BEGIN PGP PUBLIC KEY BLOCK-----
</span></span><span style=display:flex><span>xxxx
</span></span><span style=display:flex><span>-----END PGP PUBLIC KEY BLOCK-----
</span></span><span style=display:flex><span>[root@centos8 ~]#rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
</span></span><span style=display:flex><span>[root@centos8 rpm-gpg]#rpm -K /misc/cd/AppStream/Packages/httpd-2.4.37-
</span></span><span style=display:flex><span>16.module_el8.1.0+256+ae790463.x86_64.rpm
</span></span><span style=display:flex><span>/misc/cd/AppStream/Packages/httpd-2.4.37-
</span></span><span style=display:flex><span>16.module_el8.1.0+256+ae790463.x86_64.rpm: digests signatures OK
</span></span><span style=display:flex><span>[root@centos8 ~]#rpm -qa &#34;gpg-pubkey*&#34;
</span></span><span style=display:flex><span>gpg-pubkey-8483c65d-5ccc5b19
</span></span><span style=display:flex><span>[root@centos8 ~]#rpm -qi gpg-pubkey-8483c65d-5ccc5b19
</span></span><span style=display:flex><span>Name : gpg-pubkey
</span></span><span style=display:flex><span>Version : 8483c65d
</span></span><span style=display:flex><span>Release : 5ccc5b19
</span></span><span style=display:flex><span>Architecture: (none)
</span></span><span style=display:flex><span>Install Date: Wed 08 Apr 2020 10:06:20 AM CST
</span></span><span style=display:flex><span>Group : Public Keys
</span></span><span style=display:flex><span>Size : 0
</span></span><span style=display:flex><span>License : pubkey
</span></span><span style=display:flex><span>Signature : (none)
</span></span><span style=display:flex><span>Source RPM : (none)
</span></span><span style=display:flex><span>Build Date : Fri 03 May 2019 11:15:37 PM CST
</span></span><span style=display:flex><span>Build Host : localhost
</span></span><span style=display:flex><span>Relocations : (not relocatable)
</span></span><span style=display:flex><span>Packager : CentOS (CentOS Official Signing Key) &lt;security@centos.org&gt;
</span></span><span style=display:flex><span>Summary : gpg(CentOS (CentOS Official Signing Key) &lt;security@centos.org&gt;)
</span></span><span style=display:flex><span>Description :
</span></span><span style=display:flex><span>-----BEGIN PGP PUBLIC KEY BLOCK-----
</span></span><span style=display:flex><span>Version: rpm-4.14.2 (NSS-3)
</span></span><span style=display:flex><span>xxxx
</span></span><span style=display:flex><span>-----END PGP PUBLIC KEY BLOCK-----
</span></span></code></pre></div><p>范例：校验包文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>[root@centos8 ~]#rpm -K /misc/cd/BaseOS/Packages/tree-1.7.0-15.el8.x86_64.rpm
</span></span><span style=display:flex><span>/misc/cd/BaseOS/Packages/tree-1.7.0-15.el8.x86_64.rpm: digests signatures OK
</span></span><span style=display:flex><span>[root@centos8 ~]#cp /misc/cd/BaseOS/Packages/tree-1.7.0-15.el8.x86_64.rpm /data
</span></span><span style=display:flex><span>[root@centos8 ~]#cd /data
</span></span><span style=display:flex><span>[root@centos8 data]#ll
</span></span><span style=display:flex><span>total 60
</span></span><span style=display:flex><span>-r--r--r-- 1 root root 60780 Apr 8 10:11 tree-1.7.0-15.el8.x86_64.rpm
</span></span><span style=display:flex><span>[root@centos8 data]#echo &gt;&gt;tree-1.7.0-15.el8.x86_64.rpm
</span></span><span style=display:flex><span>[root@centos8 data]#ll tree-1.7.0-15.el8.x86_64.rpm
</span></span><span style=display:flex><span>-r--r--r-- 1 root root 60781 Apr 8 10:11 tree-1.7.0-15.el8.x86_64.rpm
</span></span><span style=display:flex><span>[root@centos8 data]#cd
</span></span><span style=display:flex><span>[root@centos8 ~]#rpm -K /data/tree-1.7.0-15.el8.x86_64.rpm
</span></span><span style=display:flex><span>/data/tree-1.7.0-15.el8.x86_64.rpm: DIGESTS SIGNATURES NOT OK
</span></span></code></pre></div><p>软件在安装时，会将包里的每个文件的元数据，如：大小，权限，所有者，时间等记录至rpm相关的数
据库中，可以用来检查包中的文件是否和当初安装时有所变化</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm {-V|--verify} [select-options] [verify-options]
</span></span><span style=display:flex><span>#示例：
</span></span><span style=display:flex><span>[root@centos8 ~]#rpm -V centos-release
</span></span><span style=display:flex><span>S.5....T. c /etc/issue
</span></span><span style=display:flex><span>S file Size differs
</span></span><span style=display:flex><span>M Mode differs (includes permissions and file type)
</span></span><span style=display:flex><span>5 digest (formerly MD5 sum) differs
</span></span><span style=display:flex><span>D Device major/minor number mismatch
</span></span><span style=display:flex><span>L readLink(2) path mismatch
</span></span><span style=display:flex><span>U User ownership differs
</span></span><span style=display:flex><span>G Group ownership differs
</span></span><span style=display:flex><span>T mTime differs
</span></span><span style=display:flex><span>P capabilities differ
</span></span><span style=display:flex><span>. (点) 表示当前位置代表的字符含义一致
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c 所在的位置表示文件类型
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c 配置文件
</span></span><span style=display:flex><span>d 文件数据文件
</span></span><span style=display:flex><span>g 该文件不属于某个文件(少数情况)
</span></span><span style=display:flex><span>l 许可证文件(license file)
</span></span><span style=display:flex><span>r 自述文件(READ ME)
</span></span></code></pre></div><h3 id=数据库维护>数据库维护
<a class=header-anchor href=#%e6%95%b0%e6%8d%ae%e5%ba%93%e7%bb%b4%e6%8a%a4></a></h3><p>rpm包安装时生成的信息，都放在rpm数据库中</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span><span style=color:#f92672>/</span><span style=color:#66d9ef>var</span><span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>rpm
</span></span></code></pre></div><p>可以重建数据库</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>rpm {--initdb|--rebuilddb}
</span></span><span style=display:flex><span>initdb: 初始化，如果事先不存在数据库，则新建之，否则，不执行任何操作
</span></span><span style=display:flex><span>rebuilddb：重建已安装的包头的数据库索引目录
</span></span></code></pre></div><h2 id=yum和dnf>yum和dnf
<a class=header-anchor href=#yum%e5%92%8cdnf></a></h2><p>yum/dnf 工作原理<br>yum/dnf 是基于C/S 模式</p><ul><li>yum 服务器存放rpm包和相关包的元数据库</li><li>yum 客户端访问yum服务器进行安装或查询等
yum 实现过程<br>先在yum服务器上创建 yum repository（仓库），在仓库中事先存储了众多rpm包，以及包的相关的
元数据文件（放置于特定目录repodata下），当yum客户端利用yum/dnf工具进行安装时包时，会自动
下载repodata中的元数据，查询远数据是否存在相关的包及依赖关系，自动从仓库中找到相关包下载并
安装。</li></ul><h3 id=yum客户端配置>yum客户端配置
<a class=header-anchor href=#yum%e5%ae%a2%e6%88%b7%e7%ab%af%e9%85%8d%e7%bd%ae></a></h3><p><strong>yum客户端配置文件</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>/etc/yum.conf                   #为所有仓库提供公共配置
</span></span><span style=display:flex><span>/etc/yum.repos.d/*.repo：       #为每个仓库的提供配置文件
</span></span></code></pre></div><h4 id=yum-源配置过程>yum 源配置过程
<a class=header-anchor href=#yum-%e6%ba%90%e9%85%8d%e7%bd%ae%e8%bf%87%e7%a8%8b></a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>yum -y install autofs
</span></span><span style=display:flex><span>systemctl enable --now autofs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mkdir /etc/yum.repos.d/backup
</span></span><span style=display:flex><span>mv /etc/yum.repos.d/*.repo /etc/yum.repos.d/backup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cp base.repo /etc/yum.repos.d/
</span></span><span style=display:flex><span>```
</span></span><span style=display:flex><span>**帮助参考：** man 5 yum.conf  
</span></span><span style=display:flex><span>**repo仓库配置文件指向的定义：**  
</span></span></code></pre></div><p>[repositoryID]
name=Some name for this repository
baseurl=url://path/to/repository/
enabled={1|0}
gpgcheck={1|0}
gpgkey=URL
enablegroups={1|0}
failovermethod={roundrobin|priority}
roundrobin：意为随机挑选，默认值
priority:按顺序访问
cost= 默认为1000</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>**yum服务器的baseurl形式：**
</span></span></code></pre></div><p>file:// 本地路径
http://
https://
ftp://</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>**注意：yum仓库指向的路径一定必须是repodata目录所在目录**
</span></span><span style=display:flex><span>**相关变量**
</span></span></code></pre></div><p>yum的repo配置文件中可用的变量：
$releasever: 当前OS的发行版的主版本号，如：8，7，6
$arch: CPU架构，如：aarch64, i586, i686，x86_64等
$basearch：系统基础平台；i386, x86_64
$contentdir：表示目录，比如：centos-8，centos-7
$YUM0-$YUM9:自定义变量</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：
</span></span></code></pre></div><p>http://server/centos/$releasever/$basearch/
http://server/centos/7/x86_64
http://server/centos/6/i386</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：CentOS 8 配置文件
</span></span></code></pre></div><p>[root@centos8 ~]# ll /etc/yum.conf
lrwxrwxrwx. 1 root root 12 May 14 2019 /etc/yum.conf -> dnf/dnf.conf
[root@centos8 ~]#cat /etc/yum.conf
[main]
gpgcheck=1 #安装包前要做包的合法和完整性校验
installonly_limit=3 #同时可以安装3个包，最小值为2，如设为0或1，为不限制
clean_requirements_on_remove=True #删除包时，是否将不再使用的包删除
best=True #升级时，自动选择安装最新版，即使缺少包的依赖</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：CentOS 7 的配置文件
</span></span></code></pre></div><p>[root@centos7 ~]# ll /etc/yum.conf
-rw-r&ndash;r&ndash;. 1 root root 970 Aug 8 19:57 /etc/yum.conf
[root@centos7 ~]# cat /etc/yum.conf
[main]
cachedir=/var/cache/yum/$basearch/$releasever #缓存路径
keepcache=0 #如果为1,则下载rpm并缓存下来,不删除,默认安装rpm后会删除rpm包
debuglevel=2
logfile=/var/log/yum.log
exactarch=1
obsoletes=1
gpgcheck=1
plugins=1
installonly_limit=5
bugtracker_url=http://bugs.centos.org/set_project.php?
project_id=23&amp;ref=http://bugs.centos.org/bug_report_page.php?category=yum
distroverpkg=centos-release</p><h1 id=this-is-the-default-if-you-make-this-bigger-yum-wont-see-if-the-metadata>This is the default, if you make this bigger yum won&rsquo;t see if the metadata
<a class=header-anchor href=#this-is-the-default-if-you-make-this-bigger-yum-wont-see-if-the-metadata></a></h1><h1 id=is-newer-on-the-remote-and-so-youll-gain-the-bandwidth-of-not-having-to>is newer on the remote and so you&rsquo;ll &ldquo;gain&rdquo; the bandwidth of not having to
<a class=header-anchor href=#is-newer-on-the-remote-and-so-youll-gain-the-bandwidth-of-not-having-to></a></h1><h1 id=download-the-new-metadata-and-pay-for-it-by-yum-not-having-correct>download the new metadata and &ldquo;pay&rdquo; for it by yum not having correct
<a class=header-anchor href=#download-the-new-metadata-and-pay-for-it-by-yum-not-having-correct></a></h1><h1 id=information>information.
<a class=header-anchor href=#information></a></h1><h1 id=it-is-esp-important-to-have-correct-metadata-for-distributions-like>It is esp. important, to have correct metadata, for distributions like
<a class=header-anchor href=#it-is-esp-important-to-have-correct-metadata-for-distributions-like></a></h1><h1 id=fedora-which-dont-keep-old-packages-around-if-you-dont-like-this-checking>Fedora which don&rsquo;t keep old packages around. If you don&rsquo;t like this checking
<a class=header-anchor href=#fedora-which-dont-keep-old-packages-around-if-you-dont-like-this-checking></a></h1><h1 id=interupting-your-command-line-usage-its-much-better-to-have-something>interupting your command line usage, it&rsquo;s much better to have something
<a class=header-anchor href=#interupting-your-command-line-usage-its-much-better-to-have-something></a></h1><h1 id=manually-check-the-metadata-once-an-hour-yum-updatesd-will-do-this>manually check the metadata once an hour (yum-updatesd will do this).
<a class=header-anchor href=#manually-check-the-metadata-once-an-hour-yum-updatesd-will-do-this></a></h1><h1 id=metadata_expire90m>metadata_expire=90m
<a class=header-anchor href=#metadata_expire90m></a></h1><h1 id=put-your-repos-here-or-in-separate-files-named-filerepo>PUT YOUR REPOS HERE OR IN separate files named file.repo
<a class=header-anchor href=#put-your-repos-here-or-in-separate-files-named-filerepo></a></h1><h1 id=in-etcyumreposd>in /etc/yum.repos.d
<a class=header-anchor href=#in-etcyumreposd></a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>**baseurl 指向的路径**
</span></span><span style=display:flex><span>阿里云提供了写好的CentOS,Rocky和ubuntu的仓库文件下载链接  
</span></span><span style=display:flex><span>[http://mirrors.aliyun.com/repo/](http://mirrors.aliyun.com/repo/)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Rocky 系统的yum源
</span></span></code></pre></div><p>#南京大学
<a href=https://mirror.nju.edu.cn/rocky/$releasever/ title=https://mirror.nju.edu.cn/rocky/$releasever/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirror.nju.edu.cn/rocky/$releasever/
<i class="fa fa-external-link-alt"></i>
</a>#上海交大
<a href=https://mirrors.sjtug.sjtu.edu.cn/rocky/$releasever/ title=https://mirrors.sjtug.sjtu.edu.cn/rocky/$releasever/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.sjtug.sjtu.edu.cn/rocky/$releasever/
<i class="fa fa-external-link-alt"></i>
</a>#山东大学
<a href=https://mirrors.sdu.edu.cn/rocky/$releasever/ title=https://mirrors.sdu.edu.cn/rocky/$releasever/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.sdu.edu.cn/rocky/$releasever/
<i class="fa fa-external-link-alt"></i></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>CentOS系统的yum源
</span></span></code></pre></div><p>#阿里云
<a href=https://mirrors.aliyun.com/centos/$releasever/ title=https://mirrors.aliyun.com/centos/$releasever/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.aliyun.com/centos/$releasever/
<i class="fa fa-external-link-alt"></i>
</a>#腾讯云
<a href=https://mirrors.cloud.tencent.com/centos/$releasever/ title=https://mirrors.cloud.tencent.com/centos/$releasever/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.cloud.tencent.com/centos/$releasever/
<i class="fa fa-external-link-alt"></i>
</a>#华为云
<a href=https://repo.huaweicloud.com/centos/$releasever/ title=https://repo.huaweicloud.com/centos/$releasever/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://repo.huaweicloud.com/centos/$releasever/
<i class="fa fa-external-link-alt"></i>
</a>#清华大学
<a href=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/ title=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/
<i class="fa fa-external-link-alt"></i></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>EPEL的yum源
</span></span></code></pre></div><p>#阿里云
<a href=https://mirrors.aliyun.com/epel/$releasever/x86_64 title=https://mirrors.aliyun.com/epel/$releasever/x86_64 rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.aliyun.com/epel/$releasever/x86_64
<i class="fa fa-external-link-alt"></i>
</a>#腾讯云
<a href=https://mirrors.cloud.tencent.com/epel/$releasever/x86_64 title=https://mirrors.cloud.tencent.com/epel/$releasever/x86_64 rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.cloud.tencent.com/epel/$releasever/x86_64
<i class="fa fa-external-link-alt"></i>
</a>#华为云
<a href=https://mirrors.huaweicloud.com/epel/$releasever/x86_64 title=https://mirrors.huaweicloud.com/epel/$releasever/x86_64 rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.huaweicloud.com/epel/$releasever/x86_64
<i class="fa fa-external-link-alt"></i>
</a>#清华大学
<a href=https://mirrors.tuna.tsinghua.edu.cn/epel/$releasever/x86_64 title=https://mirrors.tuna.tsinghua.edu.cn/epel/$releasever/x86_64 rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.tuna.tsinghua.edu.cn/epel/$releasever/x86_64
<i class="fa fa-external-link-alt"></i></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>阿里巴巴开源软件  
</span></span><span style=display:flex><span>[https://opsx.alibaba.com/](https://opsx.alibaba.com/)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>范例：为CentOS7用系统安装光盘作的本地yum仓库
</span></span></code></pre></div><p>#挂载光盘至某目录,如/mnt/cdrom
mount /dev/cdrom /mnt/cdrom
#创建配置文件
[root@centos7 ~]#vim /etc/yum.repos.d/centos7.repo
[CentOS7]
name=CentOS 7
baseurl=file:///mnt/cdrom
gpgcheck=0
enabled=1</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：为CentOS 8 配置 yum 的系统和EPEL源仓库
</span></span></code></pre></div><p>[root@centos8 ~]#cat /etc/yum.repos.d/base.repo
[BaseOS]
name=BaseOS
baseurl=file:///misc/cd/BaseOS
gpgcheck=1
gpgkey=/etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</p><p>[AppStream]
name=AppStream
baseurl=file:///misc/cd/AppStream
gpgcheck=0</p><p>[epel]
name=EPEL
baseurl=http://mirrors.aliyun.com/epel/$releasever/Everything/$basearch
gpgcheck=0
enabled=1</p><p>[extras]
name=extras
baseurl=https://mirrors.aliyun.com/centos/$releasever/extras/$basearch/os
gpgcheck=0</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>注意：与之前的版本不同，CentOS 8 系统有两个yum 源：BaseOS和AppStream ，需要分别设置两个
</span></span><span style=display:flex><span>仓库  
</span></span><span style=display:flex><span>范例：用脚本实现创建yum仓库配置文件  
</span></span></code></pre></div><p>[root@centos7 ~]# cat yum.sh
#!/bin/bash
mkdir /etc/yum.repos.d/backup
mv /etc/yum.repos.d/*.repo /etc/yum.repos.d/backup
cat > /etc/yum.repos.d/base.repo &#171;EOF
[base]
name=base
baseurl=https://mirrors.aliyun.com/centos/$releasever/os/$basearch
gpgcheck=0
EOF</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>**yum-config-manager命令**
</span></span><span style=display:flex><span>可以生成yum仓库的配置文件及启用或禁用仓库，来自于yum-utils包  
</span></span><span style=display:flex><span>格式：
</span></span></code></pre></div><p>#增加仓库
yum-config-manager &ndash;add-repo URL或file
#禁用仓库
yum-config-manager &ndash;disable &ldquo;仓库名&rdquo;
#启用仓库
yum-config-manager &ndash;enable &ldquo;仓库名&rdquo;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### yum命令
</span></span><span style=display:flex><span>yum命令的用法：
</span></span></code></pre></div><p>yum [options] [command] [package &mldr;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>yum的命令行选项：
</span></span></code></pre></div><p>-y #自动回答为"yes"
-q #静默模式
&ndash;nogpgcheck #禁止进行gpg check
&ndash;enablerepo=repoidglob #临时启用此处指定的repo，支持通配符，如："*"
&ndash;disablerepo=repoidglob #临时禁用此处指定的repo,和上面语句同时使用，放在后面的生效</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 显示仓库列表
</span></span></code></pre></div><p>yum repolist [all|enabled|disabled]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback></code></pre></div><p>[root@rocky ~]# yum repolist
repo id repo name
appstream Rocky Linux 9 - AppStream
baseos Rocky Linux 9 - BaseOS
epel Extra Packages for Enterprise Linux 9 - x86_64
epel-cisco-openh264 Extra Packages for Enterprise Linux 9 openh264 (From Cisco) - x86_64
extras Rocky Linux 9 - Extras
[root@rocky ~]# yum repolist &ndash;disabled
repo id repo name
appstream-debuginfo Rocky Linux 9 - AppStream - Debug
appstream-source Rocky Linux 9 - AppStream - Source
baseos-debuginfo Rocky Linux 9 - BaseOS - Debug
baseos-source Rocky Linux 9 - BaseOS - Source
crb Rocky Linux 9 - CRB
crb-debuginfo Rocky Linux 9 - CRB - Debug
crb-source Rocky Linux 9 - CRB - Source</p><p>[root@rocky ~]# yum repolist all
repo id repo name status
appstream Rocky Linux 9 - AppStream enabled
appstream-debuginfo Rocky Linux 9 - AppStream - Debug disabled
appstream-source Rocky Linux 9 - AppStream - Source disabled
baseos Rocky Linux 9 - BaseOS enabled
baseos-debuginfo Rocky Linux 9 - BaseOS - Debug disabled
[root@rocky ~]# yum &ndash;enablerepo=ep* &ndash;disablerepo=A* repolist
No repository match: A*
repo id repo name
appstream Rocky Linux 9 - AppStream
baseos Rocky Linux 9 - BaseOS
epel Extra Packages for Enterprise Linux 9 - x86_64
epel-cisco-openh264 Extra Packages for Enterprise Linux 9 openh264 (From Cisco) - x86_64
epel-cisco-openh264-debuginfo Extra Packages for Enterprise Linux 9 openh264 (From Cisco) - x86_64 - Debug</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例: 显示仓库的详细信息
</span></span></code></pre></div><p>[root@centos8 ~]#yum repolist -v
Loaded plugins: builddep, changelog, config-manager, copr, debug, debuginfo-
install, download, generate_completion_cache, needs-restarting, playground,
repoclosure, repodiff, repograph, repomanage, reposync
YUM version: 4.2.17
cachedir: /var/cache/dnf
&mldr;&mldr;&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 更新仓库元数据
</span></span><span style=display:flex><span>备份仓库配置文件，以防更新过程中出现问题。
</span></span><span style=display:flex><span>```cp -p /etc/yum.repos.d/* /etc/yum.repos.d_backup/```
</span></span></code></pre></div><p>yum clean all
yum makecache</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>更新系统。这将安装所有可用的更新。
</span></span></code></pre></div><p>yum update</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>只更新内核
</span></span></code></pre></div><p>yum update kernel</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>遇到任何依赖问题或错误，可以尝试使用以下命令来解决：
</span></span></code></pre></div><p>yum update &ndash;best &ndash;allowerasing</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>
</span></span><span style=display:flex><span>#### 显示程序包
</span></span></code></pre></div><p>yum list
yum list [all | glob_exp1] [glob_exp2] [&mldr;]
yum list {available|installed|updates} [glob_exp1] [&mldr;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：
</span></span></code></pre></div><p>[root@centos8 data]#dnf list mariadb-server
Last metadata expiration check: 0:05:03 ago on Sun 08 Dec 2019 04:11:17 PM CST.
Available Packages
mariadb-server.x86_64 3:10.3.11-2.module_el8.0.0+35+6f2527ed
AppStream
[root@centos8 data]#dnf list mariadb-server &ndash;showduplicates
Last metadata expiration check: 0:05:11 ago on Sun 08 Dec 2019 04:11:17 PM CST.
Available Packages
mariadb-server.x86_64 3:10.3.11-2.module_el8.0.0+35+6f2527ed
AppStream
[root@centos8 data]#dnf list mariadb-server &ndash;disablerepo=AppStream
Last metadata expiration check: 0:05:23 ago on Sun 08 Dec 2019 04:11:17 PM CST.
Available Packages
MariaDB-server.x86_64 10.4.10-1.el8
mariadb2
[root@centos8 data]#dnf list mariadb-server &ndash;showduplicates &ndash;
disablerepo=AppStream
Last metadata expiration check: 0:05:41 ago on Sun 08 Dec 2019 04:11:17 PM CST.
Available Packages
MariaDB-server.x86_64 10.3.17-1.el8
mariadb
MariaDB-server.x86_64 10.3.18-1.el8
mariadb
MariaDB-server.x86_64 10.3.20-1.el8
mariadb
MariaDB-server.x86_64 10.4.7-1.el8
mariadb2
MariaDB-server.x86_64 10.4.8-1.el8
mariadb2
MariaDB-server.x86_64 10.4.10-1.el8
mariadb2
[root@centos8 ~]#yum &ndash;disablerepo=&ldquo;A*&rdquo; &ndash;disablerepo=&ldquo;B*&rdquo; &ndash;disablerepo=&ldquo;e*&rdquo;
list available</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>只查看已经安装的包
</span></span></code></pre></div><p>yum list installed|head</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>查看可安装的包
</span></span></code></pre></div><p>yum list available |head</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>查看可以升级的包
</span></span></code></pre></div><p>yum list updates</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>查看指定的包
</span></span></code></pre></div><p>yum list exim
#支持通配符
yum list exim*</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 安装程序包
</span></span></code></pre></div><p>yum install package1 [package2] [&mldr;]
yum reinstall package1 [package2] [&mldr;] #重新安装
&ndash;downloadonly #只下载相关包默认至/var/cache/yum/x86_64/7/目录下,而不执行
install/upgrade/erase
&ndash;downloaddir=<path>, &ndash;destdir=<path> #&ndash;downloaddir选项来指定下载的目录,如果不存在
自动创建</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>####  安装 EPEL 源包
</span></span><span style=display:flex><span>范例：安装epel源
</span></span></code></pre></div><p>[root@centos7 ~]#yum -y install epel-release
[root@centos7 ~]#yum -y install sl
[root@centos7 ~]#rpm -ql sl
/usr/bin/sl
/usr/share/doc/sl-5.02
/usr/share/doc/sl-5.02/LICENSE
/usr/share/doc/sl-5.02/README.ja.md
/usr/share/doc/sl-5.02/README.md
/usr/share/man/ja/man1/sl.1.ja.gz
/usr/share/man/man1/sl.1.gz
#运行安装sl程序，可以看到下面火车，这标志着我们可以当老司机了
[root@centos7 ~]#sl -a</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback></code></pre></div><p>[root@centos8 ~]#dnf -y install cowsay</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 安装 SCL 源包
</span></span></code></pre></div><p>#centos-release-scl 由extras仓库提供
[root@centos7 ~]#yum install centos-release-scl -y
[root@centos7 ~]#rpm -ql centos-release-scl
/etc/pki/rpm-gpg
/etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-SIG-SCLo
/etc/yum.repos.d/CentOS-SCLo-scl.repo
/usr/share/doc/centos-release-scl/GPL
[root@centos7 ~]#yum install rh-php73-php-fpm -</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 升级最新内核
</span></span><span style=display:flex><span>范例：利用elrepo源在CentOS 7 安装新版内核
</span></span><span style=display:flex><span>说明： The difference is that kernel-lt is based on a long term support branch and kernel-ml is
</span></span><span style=display:flex><span>based on the mainline stable branch.
</span></span></code></pre></div><p>[root@centos7 ~]#yum install
<a href=https://www.elrepo.org/elrepo-release-7.0- title=https://www.elrepo.org/elrepo-release-7.0- rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://www.elrepo.org/elrepo-release-7.0-
<i class="fa fa-external-link-alt"></i>
</a>4.el7.elrepo.noarch.rpm
[root@centos7 ~]#rpm -ql elrepo-release-7.0-4.el7.elrepo
/etc/pki/elrepo
/etc/pki/elrepo/SECURE-BOOT-KEY-elrepo.org.der</p><p>&mldr;.</p><p>[root@centos7 ~]#yum repolist</p><p>&mldr;.</p><p>[root@centos7 ~]#cat /etc/yum.repos.d/elrepo.repo</p><h1 id=name-elrepoorg-community-enterprise-linux-repository-for-el7>Name: ELRepo.org Community Enterprise Linux Repository for el7
<a class=header-anchor href=#name-elrepoorg-community-enterprise-linux-repository-for-el7></a></h1><h1 id=url-httpelrepoorg>URL:
<a href=http://elrepo.org/ title=http://elrepo.org/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://elrepo.org/
<i class="fa fa-external-link-alt"></i>
</a><a class=header-anchor href=#url-httpelrepoorg></a></h1><p>&mldr;.</p><p>[root@centos7 ~]#yum &ndash;disablerepo="*" &ndash;enablerepo=&ldquo;elrepo-kernel&rdquo; list
available</p><p>&mldr;.</p><p>[root@magedu ~]#yum -y &ndash;enablerepo=&ldquo;elrepo-kernel&rdquo; install kernel-ml
[root@centos7 ~]#ls /boot</p><p>&mldr;.</p><p>[root@centos7 ~]#ls /lib/modules
3.10.0-957.el7.x86_64 5.4.6-1.el7.elrepo.x86_64
[root@centos7 ~]#reboot
[root@centos7 ~]#uname -r
5.4.6-1.el7.elrepo.x86_64</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 只下载相关的依赖包,而不安装
</span></span></code></pre></div><p>#/data/目录如果不存在,会自动创建
[root@centos8 ~]#yum -y install &ndash;downloadonly &ndash;downloaddir=/data/httpd httpd
[root@centos8 ~]#ls /data/httpd/
apr-1.6.3-9.el8.x86_64.rpm httpd-2.4.37-
16.module_el8.1.0+256+ae790463.x86_64.rpm
apr-util-1.6.1-6.el8.x86_64.rpm httpd-filesystem-2.4.37-
16.module_el8.1.0+256+ae790463.noarch.rpm
apr-util-bdb-1.6.1-6.el8.x86_64.rpm httpd-tools-2.4.37-
16.module_el8.1.0+256+ae790463.x86_64.rpm
apr-util-openssl-1.6.1-6.el8.x86_64.rpm mailcap-2.1.48-3.el8.noarch.rpm
centos-logos-httpd-80.5-2.el8.noarch.rpm mod_http2-1.11.3-
3.module_el8.1.0+213+acce2796.x86_64.rpm</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>注意: 下载包也可以通过启用配置文件实现
</span></span></code></pre></div><p>[root@centos7 ~]# cat /etc/yum.conf
[main]
cachedir=/var/cache/yum/$basearch/$releasever #缓存路径
keepcache=1 #如果为1,则下载rpm并缓存下来,不删除,默认安装rpm后会删除rpm包</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 卸载程序包
</span></span></code></pre></div><p>yum remove | erase package1 [package2] [&mldr;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 升级和降级
</span></span><span style=display:flex><span>检查可用升级：
</span></span></code></pre></div><p>yum check-update</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>升级和降级
</span></span></code></pre></div><p>yum upgrade|update [package1] [package2] [&mldr;]
yum upgrade-minimal #最小化升级
yum downgrade package1 [package2] [&mldr;] (降级)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例:
</span></span></code></pre></div><p>[root@centos7 ~]# cat /etc/yum.repos.d/base.repo
[root@centos7 ~]#yum &ndash;disablerepo=* &ndash;enablerep=updates list available
[root@centos7 ~]#yum info samba
[root@centos7 ~]#yum info samba &ndash;showduplicates
[root@centos7 ~]#yum install samba &ndash;disablerepo=updates
[root@centos7 ~]#yum update samba
[root@centos7 ~]#yum update</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 查询
</span></span><span style=display:flex><span>查看程序包information：
</span></span></code></pre></div><p>yum info [&mldr;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>查看指定的特性(可以是某文件)是由哪个程序包所提供：
</span></span></code></pre></div><p>yum provides | whatprovides feature1 [feature2] [&mldr;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>**注意：文件要写全路径，而不只是文件名，否则可能无法查询到**
</span></span><span style=display:flex><span>范例:
</span></span></code></pre></div><p>[root@centos8 ~]# ll /etc/vsftpd/vsftpd.conf
ls: cannot access &lsquo;/etc/vsftpd/vsftpd.conf&rsquo;: No such file or directory
#注意要写文件全路径才能查询到
[root@centos8 ~]#yum provides vsftpd.conf
Last metadata expiration check: 0:56:45 ago on Fri 10 Apr 2020 11:24:00 AM CST.
Error: No Matches found
[root@centos8 ~]# yum provides /etc/vsftpd/vsftpd.conf
Last metadata expiration check: 0:33:13 ago on Fri 27 Dec 2019 03:47:34 PM CST.
vsftpd-3.0.3-28.el8.x86_64 : Very Secure Ftp Daemon
Repo : AppStream
Matched from:
Filename : /etc/vsftpd/vsftpd.conf</p><p>#使用通配符
[root@centos8 ~]#yum provides */vsftpd.conf
[root@centos8 ~]#yum provides <em>/updatedb</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>以指定的关键字搜索程序包名及summary信息
</span></span></code></pre></div><p>yum search string1 [string2] [&mldr;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>查看指定包所依赖的capabilities：
</span></span></code></pre></div><p>yum deplist package1 [package2] [&mldr;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：
</span></span></code></pre></div><p>[root@rocky ~]# dnf info bash
Last metadata expiration check: 0:44:51 ago on Thu Dec 19 13:11:50 2024.
Installed Packages
Name : bash
Version : 5.1.8
Release : 9.el9
Architecture : x86_64
Size : 7.4 M
Source : bash-5.1.8-9.el9.src.rpm
Repository : @System
From repo : minimal
Summary : The GNU Bourne Again shell
URL :
<a href=https://www.gnu.org/software/bash title=https://www.gnu.org/software/bash rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://www.gnu.org/software/bash
<i class="fa fa-external-link-alt"></i>
</a>License : GPLv3+
Description : The GNU Bourne Again shell (Bash) is a shell or command language
: interpreter that is compatible with the Bourne shell (sh). Bash
: incorporates useful features from the Korn shell (ksh) and the C shell
: (csh). Most sh scripts can be run by bash without modification.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：
</span></span></code></pre></div><p>[root@rocky ~]# dnf list bash*
Last metadata expiration check: 0:45:18 ago on Thu Dec 19 13:11:50 2024.
Installed Packages
bash.x86_64 5.1.8-9.el9 @minimal
Available Packages
bash-argsparse.noarch 1.8-1.el9 epel
bash-color-prompt.noarch 0.4-1.el9 epel
bash-completion.noarch 1:2.11-5.el9 baseos</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例: rocky 9 查看未安装包的文件列表
</span></span></code></pre></div><p>[root@rocky ~]# rpm -q memcached
package memcached is not installed
[root@rocky ~]# dnf repoquery -l memcached
Last metadata expiration check: 0:47:40 ago on Thu Dec 19 13:11:50 2024.
/etc/sysconfig/memcached
/usr/bin/memcached
/usr/bin/memcached-tool
/usr/lib/.build-id
/usr/lib/.build-id/96
/usr/lib/.build-id/96/4a9e960bf63303d159ce727a7eafac8cd1ffe7
/usr/lib/systemd/system/memcached.service
/usr/lib/sysusers.d/memcached.conf</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例: CentOS 7 查看未安装包的文件列表
</span></span></code></pre></div><p>[root@centos7 ~]#rpm -q memcached
package memcached is not installed
[root@centos7 ~]#yum -y install yum-utils
[root@centos7 ~]#repoquery -ql memcached repoquery 命令的主要功能是从 Yum 仓库中查询 RPM 包的信息，包括依赖关系、文件列表和描述等。这个命令属于 yum-utils 包，是一个扩展工具，用于补充和增强 yum 的功能，尤其是在查询软件包关系方面。
/etc/sysconfig/memcached
/usr/bin/memcached
&mldr;&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span><span style=color:#75715e>### 仓库缓存</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>清除目录</span><span style=color:#f92672>/</span><span style=color:#66d9ef>var</span><span style=color:#f92672>/</span>cache<span style=color:#f92672>/</span>yum<span style=color:#f92672>/</span><span style=color:#960050;background-color:#1e0010>缓存</span>
</span></span></code></pre></div><p>yum clean [ packages | metadata | expire-cache | rpmdb | plugins | all ]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>构建缓存：
</span></span></code></pre></div><p>yum makecache</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：管理yum缓存
</span></span></code></pre></div><p>[root@centos7 ~]#du -sh /var/cache/yum
93M /var/cache/yum
[root@centos7 ~]#ls /var/cache/yum/x86_64/7/
base epel extras timedhosts timedhosts.txt
[root@magedu ~]#yum clean all
Loaded plugins: fastestmirror
Cleaning repos: base epel extras
Cleaning up list of fastest mirrors
[root@centos7 ~]#du -sh /var/cache/yum
4.0K /var/cache/yum
[root@centos7 ~]#yum makecache
&mldr;&mldr;
Metadata Cache Created
[root@centos7 ~]#du -sh /var/cache/yum
276M /var/cache/yum</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 查看yum事务历史
</span></span><span style=display:flex><span>yum 执行安装卸载命令会记录到相关日志中  
</span></span><span style=display:flex><span>日志 文件：  
</span></span></code></pre></div><p>#CentOS 7以前版本日志
/var/log/yum.log
#CentOS 8 版本日志
/var/log/dnf.rpm.log
/var/log/dnf.log</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>日志命令
</span></span></code></pre></div><p>yum history [info|list|packages-list|packages-info|summary|addon-
info|redo|undo|rollback|new|sync|stats]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：
</span></span></code></pre></div><h2 id=id--command-line--date-and-time--actions--altered>[root@centos8 ~]#dnf history
ID | Command line | Date and time | Action(s) | Altered
<a class=header-anchor href=#id--command-line--date-and-time--actions--altered></a></h2><p>22 | install yum-utils | 2019-12-22 13:44 | Install | 1
21 | remove vsftpd | 2019-12-22 13:39 | Removed | 1
20 | install vsftpd | 2019-12-22 13:39 | Install | 1
19 | install python3 | 2019-12-22 12:26 | Install | 3
18 | install perl | 2019-12-22 12:25 | Install | 156
17 | install httpd -y | 2019-12-21 20:21 | Install | 10
&mldr;省略&mldr;
[root@centos8 ~]#dnf history info 22
Transaction ID : 22
Begin time : Sun 22 Dec 2019 01:44:08 PM CST
Begin rpmdb : 607:35cd823ff347e56ceb688a9f72715eabb3c53d41
End time : Sun 22 Dec 2019 01:44:08 PM CST (0 seconds)
End rpmdb : 608:24139ec38fc131c182b75fdaad0626692045da94
User : root <root>Return-Code : Success
Releasever : 8
Command Line : install yum-utils
Packages Altered:
Install dnf-utils-4.0.2.2-3.el8.noarch @BaseOS
[root@centos8 ~]#dnf history undo 22 -y
Removed:
dnf-utils-4.0.2.2-3.el8.noarch
Complete!
[root@centos8 ~]#dnf history redo 22 -y</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 安装及升级本地程序包
</span></span></code></pre></div><p>yum localinstall|install rpmfile1 [rpmfile2] [&mldr;]
yum localupdate|update rpmfile1 [rpmfile2] [&mldr;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 查看包的安全警报
</span></span></code></pre></div><p>yum updateinfo &ndash;summary|&ndash;list|&ndash;info</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 包组管理的相关命令
</span></span></code></pre></div><p>yum grouplist [hidden] [groupwildcard] [&mldr;]
yum groupinstall group1 [group2] [&mldr;]
yum groupupdate group1 [group2] [&mldr;]
yum groupremove group1 [group2] [&mldr;]
yum groupinfo group1 [&mldr;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 实现私用 yum 仓库
</span></span><span style=display:flex><span>下载所有yum仓库的相关包和meta 数据
</span></span></code></pre></div><p>#CentOS 8 dnf 工具集成
dnf reposync &ndash;help #查看帮助
#默认只下载rpm包，不下载 meta数据，需要指定&ndash;download-metadata 才能下载 meta
dnf reposync &ndash;repoid=REPOID &ndash;download-metadata -p /path
#CentOS 7 以前版本，reposync工具来自于yum-utils包
reposync &ndash;repoid=REPOID &ndash;download-metadata -p /path</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>创建私有yum仓库：
</span></span></code></pre></div><p>createrepo [options] <directory></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：创建局域网的基于Base的私有yum源
</span></span></code></pre></div><p>#仓库服务器配置
[root@repo-server ~]#yum -y install httpd
[root@repo-server ~]#systemctl enable &ndash;now httpd
[root@repo-server ~]#mkdir /var/www/html/centos/8 -pv
[root@repo-server ~]#mount /dev/sr0 /mnt/
[root@repo-server ~]#cp -a /mnt/* /var/www/html/centos/8
#yum客户端配置
[root@repo-client ~]#cat /etc/yum.repos.d/test.repo
[BaseOS]
name=BaseOS
baseurl=http://10.0.0.8/centos/8/BaseOS
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
[AppStream]
name=Appstream
baseurl=http://10.0.0.8/centos/8/AppStream/
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：下载阿里云的extras源，制作私有yum源
</span></span></code></pre></div><p>[root@repo-server ~]#yum repolist
Last metadata expiration check: 0:10:14 ago on Wed 08 Apr 2020 05:42:07 PM CST.
repo id repo name status
AppStream AppStream 4,755
BaseOS BaseOS 1,659
epel EPEL 5,206
extras</p><p>[root@repo-server ~]#dnf reposync &ndash;repoid=extras &ndash;download-metadata -p
/var/www/html/centos</p><p>[root@repo-server ~]#ls /var/www/html/centos/
8 extras
[root@repo-server ~]#ls /var/www/html/centos/extras/
Packages repodata</p><p>[root@repo-client ~]#yum repolist
Last metadata expiration check: 0:02:31 ago on Wed 08 Apr 2020 06:01:20 PM CST.
repo id repo name
status
AppStream Appstream
4,755
BaseOS BaseOS
1,659
extras extras
12</p><p>[root@repo-client ~]#cat /etc/yum.repos.d/test.repo
[BaseOS]
name=BaseOS
baseurl=http://10.0.0.8/centos/8/BaseOS
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
[AppStream]
name=Appstream
baseurl=http://10.0.0.8/centos/8/AppStream/
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</p><p>[extras]
name=extras
baseurl=http://10.0.0.8/centos/extras/</p><p>[root@repo-client ~]#yum &ndash;disablerepo=* &ndash;enablerepo=extras list available
[root@repo-client ~]#yum -y install epel-release</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>
</span></span><span style=display:flex><span>范例：下载阿里云的EPEL源，制作私有yum源
</span></span></code></pre></div><p>[root@centos8 ~]#cat /etc/yum.repos.d/base.repo
[epel]
name=EPEL
baseurl=https://mirrors.aliyun.com/epel/8/Everything/x86_64/
gpgcheck=0
[root@centos8 ~]#dnf repolist</p><p>&mldr;..</p><p>#下载相关仓库包和元数据
[root@centos8 ~]#dnf reposync &ndash;repoid=epel &ndash;download-metadata -p
/var/www/html
#&ndash;download-metadata 加此选项可以下载元数据
#下载相关的key文件
[root@repo-server ~]#wget -P /var/www/html/epel/
<a href=https://mirrors.aliyun.com/epel/RPM-GPG-KEY-EPEL-8 title=https://mirrors.aliyun.com/epel/RPM-GPG-KEY-EPEL-8 rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.aliyun.com/epel/RPM-GPG-KEY-EPEL-8
<i class="fa fa-external-link-alt"></i></a></p><p>#下面两个步骤只有没meta数据才需要执行
#[root@centos8 ~]#dnf -y install createrepo httpd
#[root@centos8 ~]#createrepo /var/www/html/epel/</p><p>[root@centos8 ~]#ls /var/www/html/epel/
Packages repodata
[root@centos8 ~]#systemctl start httpd</p><p>[root@repo-client ~]#cat /etc/yum.repos.d/test.repo
[BaseOS]
name=BaseOS
baseurl=http://10.0.0.8/centos/8/BaseOS
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
[AppStream]
name=Appstream
baseurl=http://10.0.0.8/centos/8/AppStream/
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
[extras]
name=extras
baseurl=http://10.0.0.8/centos/extras/
[epel]
name=epel
baseurl=http://10.0.0.8/epel/
gpgkey=http://10.0.0.8/epel/RPM-GPG-KEY-EPEL-8
[root@repo-client ~]#yum repolist
extras 1.6 MB/s | 4.9 kB 00:00
epel 88 MB/s | 6.2 MB 00:00
repo id repo name status
AppStream Appstream 4,755
BaseOS BaseOS 1,659
epel epel 5,206
extras extras 12
[root@repo-client ~]#dnf install openvpn</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### DNF 介绍
</span></span><span style=display:flex><span>DNF，即DaNdiFied，是新一代的RPM软件包管理器。DNF 发行日期是2015年5月11日，DNF 包管理
</span></span><span style=display:flex><span>器采用Python 编写，发行许可为GPL v2，首先出现在Fedora 18 发行版中。在 RHEL 8.0 版本正式取代
</span></span><span style=display:flex><span>了 YUM，DNF包管理器克服了YUM包管理器的一些瓶颈，提升了包括用户体验，内存占用，依赖分
</span></span><span style=display:flex><span>析，运行速度等  
</span></span><span style=display:flex><span>配置文件：
</span></span></code></pre></div><p>/etc/dnf/dnf.conf</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>仓库文件：
</span></span></code></pre></div><p>/etc/yum.repos.d/ *.repo</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>日志：
</span></span></code></pre></div><p>/var/log/dnf.rpm.log
/var/log/dnf.log</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>DNF 使用帮助：man dnf  
</span></span><span style=display:flex><span>dnf 用法与yum一致  
</span></span><span style=display:flex><span>### yum Troubleshooting
</span></span><span style=display:flex><span>yum 和 dnf 失败最主要原因：
</span></span><span style=display:flex><span>* yum的配置文件格式或路径错误
</span></span><span style=display:flex><span>解决方法：检查/etc/yum.repos.d/*.repo文件格式
</span></span><span style=display:flex><span>* yum cache
</span></span><span style=display:flex><span>解决方法：yum clean all
</span></span><span style=display:flex><span>* 网络不通：
</span></span><span style=display:flex><span>解决方法：网卡配置
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>## 源码编译
</span></span><span style=display:flex><span>程序包编译安装：
</span></span><span style=display:flex><span>源代码--&gt;预处理--&gt;编译--&gt;汇编--&gt;链接--&gt;执行
</span></span><span style=display:flex><span>多文件：文件中的代码之间，很可能存在跨文件依赖关系  
</span></span><span style=display:flex><span>![image](https://github.com/user-attachments/assets/1f059300-362f-4adf-bbd5-4b26dad4d0d1)
</span></span><span style=display:flex><span>![image](https://github.com/user-attachments/assets/9eca0ac0-8e02-45f9-9dc8-ea8cc6a04962)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>### 编译源码的项目工具
</span></span><span style=display:flex><span>* C、C++的源码编译：使用 make 项目管理器
</span></span><span style=display:flex><span>configure脚本 --&gt; Makefile.in --&gt; Makefile
</span></span><span style=display:flex><span>相关开发工具：
</span></span><span style=display:flex><span>autoconf: 生成configure脚本
</span></span><span style=display:flex><span>automake：生成Makefile.in
</span></span><span style=display:flex><span>* java的源码编译: 使用 maven
</span></span><span style=display:flex><span>### C 语言源代码编译安装过程
</span></span><span style=display:flex><span>利用编译工具，通常只需要三个大的步骤
</span></span><span style=display:flex><span>* ./configure
</span></span><span style=display:flex><span>(1) 通过选项传递参数，指定安装路径、启用特性等；执行时会参考用户的指定以及Makefile.in文
</span></span><span style=display:flex><span>件生成Makefile
</span></span><span style=display:flex><span>(2) 检查依赖到的外部环境，如依赖的软件包
</span></span><span style=display:flex><span>* make 根据Makefile文件，会检测依赖的环境，进行构建应用程序
</span></span><span style=display:flex><span>* make install 复制文件到相应路径
</span></span><span style=display:flex><span>注意：安装前可以通过查看README，INSTALL获取帮助
</span></span><span style=display:flex><span>### 编译安装准备
</span></span><span style=display:flex><span>* 准备：安装相关的依赖包
</span></span><span style=display:flex><span>* 开发工具：make, gcc (c/c++编译器GNU C Complier)
</span></span><span style=display:flex><span>* 开发环境：开发库（glibc：标准库），头文件，可安装开发包组 Development Tools
</span></span><span style=display:flex><span>软件相关依赖包  
</span></span><span style=display:flex><span>生产实践：基于最小化安装的系统建议安装下面相关包
</span></span></code></pre></div><p>yum install gcc make autoconf gcc-c++ glibc glibc-devel pcre pcre-devel openssl
openssl-devel systemd-devel zlib-devel vim lrzsz tree tmux lsof tcpdump wget
net-tools iotop bc bzip2 zip unzip nfs-utils man-pages</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 编译安装
</span></span><span style=display:flex><span>第一步：运行 configure 脚本，生成 Makefile 文件  
</span></span><span style=display:flex><span>其选项主要功能：  
</span></span><span style=display:flex><span>* 可以指定安装位置
</span></span><span style=display:flex><span>* 指定启用的特性
</span></span><span style=display:flex><span>获取其支持使用的选项    
</span></span><span style=display:flex><span>./configure --help
</span></span><span style=display:flex><span>选项分类：  
</span></span><span style=display:flex><span>* 安装路径设定
</span></span><span style=display:flex><span>--prefix=/PATH：指定默认安装位置,默认为/usr/local/  
</span></span><span style=display:flex><span>--sysconfdir=/PATH：配置文件安装位置  
</span></span><span style=display:flex><span>System types：支持交叉编译  
</span></span><span style=display:flex><span>* 软件特性和相关指定：
</span></span><span style=display:flex><span>Optional Features: 可选特性  
</span></span><span style=display:flex><span>--disable-FEATURE  
</span></span><span style=display:flex><span>--enable-FEATURE[=ARG]  
</span></span><span style=display:flex><span>Optional Packages: 可选包  
</span></span><span style=display:flex><span>--with-PACKAGE[=ARG] 依赖包  
</span></span><span style=display:flex><span>--without-PACKAGE 禁用依赖关系  
</span></span><span style=display:flex><span>注意：通常被编译操作依赖的程序包，需要安装此程序包的&#34;开发&#34;组件，其包名一般类似于name-
</span></span><span style=display:flex><span>devel-VERSION  
</span></span><span style=display:flex><span>第二步：make  
</span></span><span style=display:flex><span>第三步：make install  
</span></span><span style=display:flex><span>### 安装后的配置
</span></span><span style=display:flex><span>1. 二进制程序目录导入至PATH环境变量中
</span></span><span style=display:flex><span>编辑文件
</span></span></code></pre></div><p>/etc/profile.d/NAME.sh</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>2. 相关用户及文件  
</span></span><span style=display:flex><span>有些开源软件编译完成后，还需要创建相关的用户及文件  
</span></span><span style=display:flex><span>3. 导入帮助手册  
</span></span><span style=display:flex><span>编辑/etc/man.config|man_db.conf文件,添加一个MANPATH  
</span></span><span style=display:flex><span>### 编译安装实战案例
</span></span><span style=display:flex><span>#### 官网下载并编译安装新版 tree
</span></span><span style=display:flex><span>范例：CentOS 7 编译安装 tree1.8
</span></span></code></pre></div><p>#1 安装相关的依赖包
[root@centos7 ~]#yum install gcc make</p><p>#2 下载源码并解压
[root@centos7 ~]#tar xvf tree-1.8.0.tgz</p><p>#3 进入解压缩的目录，README和INSTALL
[root@centos7 ~]#cd tree-1.8.0/
[root@centos7 tree-1.8.0]#cat README
[root@centos7 tree-1.8.0]#cat INSTALL</p><p>#4 修改源码的版本号
[root@centos7 tree-1.8.0]#sed -i &rsquo;s#v1.8.0#v8.8.8#&rsquo; tree.c</p><p>#5 编译准备
[root@centos7 tree-1.8.0]#vim Makefile
prefix = /apps/tree</p><p>#6 编译
[root@centos7 tree-1.8.0]#make</p><p>#7 安装
[root@centos7 tree-1.8.0]#make install</p><p>#8 修改PATH变量
#默认无法直接运行tree
[root@centos7 ~]#tree
-bash: tree: command not found</p><p>[root@centos7 ~]#echo &lsquo;PATH=/apps/tree/bin:$PATH&rsquo; > /etc/profile.d/tree.sh
. /etc/profile.d/tree.sh
#或者利用软链接实现
[root@centos7 ~]#ln -s /apps/tree/bin/tree /usr/local/bin</p><p>#9 验证结果
[root@centos7 ~]#tree &ndash;version
tree v8.8.8 (c) 1996 - 2018 by Steve Baker, Thomas Moore, Francesc Rocher,
Florian Sesser, Kyosuke Tokoro</p><p>#10 添加man帮助
#默认无法查看man
[root@centos7 ~]#man tree
No manual entry for tree</p><p>[root@centos7 ~]#vim /etc/man_db.conf
MANDATORY_MANPATH /apps/tree/man</p><p>[root@centos7 ~]#man tree</p><p>#11 运行tree查看生成的文件列表
[root@centos7 ~]#tree /apps/tree
/apps/tree
├── bin
│ └── tree
└── man
└── man1
└── tree.1
3 directories, 2 files</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 编译安装 httpd 2.4
</span></span></code></pre></div><p>#安装前准备：关闭防火墙和SELinux
#1 安装相关包
[root@centos8 ~]#dnf install gcc make autoconf apr-devel apr-util-devel pcre-
devel openssl-devel redhat-rpm-config
#2 下载并解压缩包
[root@centos8 ~]#wget
<a href=https://mirror.bit.edu.cn/apache//httpd/httpd- title=https://mirror.bit.edu.cn/apache//httpd/httpd- rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirror.bit.edu.cn/apache//httpd/httpd-
<i class="fa fa-external-link-alt"></i>
</a>2.4.46.tar.bz2
[root@centos8 ~]#tar xvf httpd-2.4.46.tar.bz2 -C /usr/local/src
#3 配置
[root@centos8 ~]#cd /usr/local/src/httpd-2.4.43/
[root@centos8 httpd-2.4.46]#./configure &ndash;prefix=/apps/httpd &ndash;
sysconfdir=/etc/httpd &ndash;enable-ssl
#4 编译并安装
[root@centos8 httpd-2.4.46]#make -j 4 && make install
#5 配置环境
[root@centos8 ~]#echo &lsquo;PATH=/apps/httpd/bin:$PATH&rsquo; > /etc/profile.d/httpd.sh
[root@centos8 ~]#. /etc/profile.d/httpd.sh
#6 运行
[root@centos8 ~]#apachectl start
#7 指定用apache用户运行
[root@centos8 ~]#useradd -r -s /sbin/nologin -d /var/www -c Apache -u 48 apache
[root@centos8 ~]#vim /etc/httpd/httpd.conf
user apache
group apache
#8 配置生效和验证
[root@centos8 ~]#apachectl restart
#9 查看进程
[root@centos8 ~]#ps aux
#10 用浏览器打开以下地址，可以看下面页面</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 一键安装 httpd2.4 脚本
</span></span></code></pre></div><p>#!/bin/bash</p><h1 id=heading><a class=header-anchor href=#heading></a></h1><p>#********************************************************************
#Author: wangxiaochun
#QQ: 29308620
#Date: 2021-10-09
#FileName: install_httpd.sh
#URL:
<a href=http://www.wangxiaochun.com title=http://www.wangxiaochun.com rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://www.wangxiaochun.com
<i class="fa fa-external-link-alt"></i>
</a>#Description: The test script
#Copyright (C): 2021 All rights reserved
#********************************************************************
CPUS=<code>grep -c processor /proc/cpuinfo</code>
HTTPD_VERSION=2.4.52
INSTALL_DIR=/apps/httpd
COLOR=&ldquo;echo -e \E[32;1m&rdquo;
END="\E[0m"</p><p>systemctl disable &ndash;now firewalld
yum -y install gcc make apr-devel apr-util-devel openssl-devel pcre-devel
redhat-rpm-config bzip2</p><p>cd /usr/local/src
rpm -q wget || yum -y install wget
wget
<a href=https://dlcdn.apache.org//httpd/httpd-$%7bHTTPD_VERSION%7d.tar.bz2 title=https://dlcdn.apache.org//httpd/httpd-${HTTPD_VERSION}.tar.bz2 rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://dlcdn.apache.org//httpd/httpd-${HTTPD_VERSION}.tar.bz2
<i class="fa fa-external-link-alt"></i>
</a>|| { $COLOR
&ldquo;下载失败，退出&rdquo; $END;exit ; }</p><p>tar xf httpd-${HTTPD_VERSION}.tar.bz2</p><p>cd httpd-${HTTPD_VERSION}</p><p>./configure &ndash;prefix=${INSTALL_DIR} &ndash;enable-ssl &ndash;disable-status</p><p>make -j $CPUS && make install</p><p>ln -s /apps/httpd/bin/apachectl /usr/local/bin/</p><p>apachectl start && $COLOR"安装成功!"$END
$COLOR"请访问:http://<code>hostname -I</code>"$END</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span><span style=color:#75715e>## Ubuntu 软件管理</span>
</span></span><span style=display:flex><span>Debian软件包通常为预编译的二进制格式的扩展名<span style=color:#e6db74>&#34;.deb&#34;</span><span style=color:#960050;background-color:#1e0010>，类似</span>rpm文件<span style=color:#960050;background-color:#1e0010>，因此安装快速，无需编译软</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>件。包文件包括特定功能或软件所必需的文件、元数据和指令</span>  
</span></span><span style=display:flex><span><span style=color:#f92672>*</span> dpkg<span style=color:#960050;background-color:#1e0010>：</span>package manager <span style=color:#66d9ef>for</span> Debian<span style=color:#960050;background-color:#1e0010>，类似于</span>rpm<span style=color:#960050;background-color:#1e0010>，</span> dpkg是基于Debian的系统的包管理器<span style=color:#960050;background-color:#1e0010>。可</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>以安装，删除和构建软件包，但无法自动下载和安装软件包或其依赖项</span>
</span></span><span style=display:flex><span><span style=color:#f92672>*</span> apt<span style=color:#960050;background-color:#1e0010>：</span>Advanced Packaging Tool<span style=color:#960050;background-color:#1e0010>，功能强大的软件管理工具，甚至可升级整个</span>Ubuntu的系统<span style=color:#960050;background-color:#1e0010>，基</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>于客户</span><span style=color:#f92672>/</span><span style=color:#960050;background-color:#1e0010>服务器架构，类似于</span>yum
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>APT工作原理  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>在服务器上先复制所有</span>DEB包<span style=color:#960050;background-color:#1e0010>，然后用</span>APT的分析工具genbasedir根据每个DEB <span style=color:#960050;background-color:#1e0010>包的包头（</span>Header<span style=color:#960050;background-color:#1e0010>）</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>信息对所有的</span>DEB包进行分析<span style=color:#960050;background-color:#1e0010>，并将该分析结果记录在文件夹</span>base内的一个DEB <span style=color:#960050;background-color:#1e0010>索引清单文件中，一</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>旦</span>APT <span style=color:#960050;background-color:#1e0010>服务器内的</span>DEB有所变动<span style=color:#960050;background-color:#1e0010>，要使用</span>genbasedir产生新的DEB索引清单<span style=color:#960050;background-color:#1e0010>。客户端在进行安装或升级</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>时先要查询</span>DEB索引清单<span style=color:#960050;background-color:#1e0010>，从而获知所有具有依赖关系的软件包，并一同下载到客户端以便安装。当客</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>户端需要安装、升级或删除某个软件包时，客户端计算机取得</span>DEB索引清单压缩文件后<span style=color:#960050;background-color:#1e0010>，会将其解压置</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>放于</span> <span style=color:#f92672>/</span><span style=color:#66d9ef>var</span><span style=color:#f92672>/</span>cache<span style=color:#f92672>/</span>apt<span style=color:#f92672>/</span><span style=color:#960050;background-color:#1e0010>，而客户端使用</span>apt<span style=color:#f92672>-</span>get install或apt<span style=color:#f92672>-</span>get upgrade命令的时候<span style=color:#960050;background-color:#1e0010>，就会将这个文件夹</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>内的数据和客户端计算机内的</span>DEB数据库比对<span style=color:#960050;background-color:#1e0010>，知道哪些</span>DEB已安装<span style=color:#960050;background-color:#1e0010>、未安装或是可以升级的</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>### dpkg 包管理器</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>帮助参看：</span>man dpkg
</span></span><span style=display:flex><span>dpkg <span style=color:#960050;background-color:#1e0010>常见用法</span>
</span></span></code></pre></div><p>#安装包，不支持包的依赖
dpkg -i package.deb</p><p>#删除包，不建议，不自动卸载依赖于它的包
dpkg -r package</p><p>#删除包（包括配置文件）
dpkg -P package</p><p>#列出当前已安装的包，类似rpm -qa
dpkg -l</p><p>#显示该包的简要说明
dpkg -l package</p><p>#列出该包的状态，包括详细信息，类似rpm –qi
dpkg -s package</p><p>#列出该包中所包含的文件，类似rpm –ql
dpkg -L package</p><p>#搜索包含pattern的包，类似rpm –qf
dpkg -S <pattern></p><p>#配置包，-a 使用，配置所有没有配置的软件包
dpkg &ndash;configure package</p><p>#列出 deb 包的内容，类似rpm –qpl
dpkg -c package.deb</p><p>#解开 deb 包的内容
dpkg &ndash;unpack package.deb</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：
</span></span></code></pre></div><p>#列出系统上安装的所有软件包
dpkg -l
#列出软件包安装的文件
dpkg -L bash
#查看/bin/bash来自于哪个软件包
dpkg -S /bin/bash
#安装本地的 .deb 文件
dpkg -i /mnt/cdrom/pool/main/z/zip/zip_3.0-11build1_amd64.deb
#卸载软件包
dpkg -r zip</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>注意：一般建议不要使用dpkg卸载软件包。因为删除包时，其它依赖它的包不会卸载，并且可能无法再
</span></span><span style=display:flex><span>正常运行
</span></span><span style=display:flex><span>### apt
</span></span><span style=display:flex><span>Debian 使用apt 工具集来管理包系统，apt-get 是其中一个常用的命令行工具，另外一款较为流行的命
</span></span><span style=display:flex><span>令行与 GUI 兼顾的工具是 aptitude ，之前最常用的 Linux 包管理命令都被分散在了 apt-get、apt-
</span></span><span style=display:flex><span>cache 和 apt-config 这三条命令中  
</span></span><span style=display:flex><span>在 2014 年apt 命令发布第一个稳定版，Ubuntu 16.04 引入新特性之一便是 apt 命令，apt 命令解决了
</span></span><span style=display:flex><span>命令过于分散的问题，它包括 apt-get 命令出现以来使用最广泛的功能选项，以及 apt-cache 和 apt-
</span></span><span style=display:flex><span>config 命令中很少用到的功能。在使用 apt 命令时，用户不必再由 apt-get 转到 apt-cache 或 apt-
</span></span><span style=display:flex><span>config，提供管理软件包所需的必要选项  
</span></span><span style=display:flex><span>apt 相当于 apt-get、apt-cache 和 apt-config 中最常用命令选项的集合  
</span></span><span style=display:flex><span>apt 具有更精减但足够的命令选项，而且参数选项的组织方式更为有效。此外，启用的几个特性也非常
</span></span><span style=display:flex><span>有帮助。例如：可以在使用 apt 命令安装或删除程序时看到进度条,apt 还会在更新存储库数据库时提示
</span></span><span style=display:flex><span>用户可升级的软件包个数  
</span></span><span style=display:flex><span>apt 与 apt-get 有一些类似的命令选项，但它并不能完全向下兼容 apt-get 命令,也即可用 apt 替换部分
</span></span><span style=display:flex><span>apt-get 系列命令，但不是全部  
</span></span><span style=display:flex><span>apt 命令用法  
</span></span><span style=display:flex><span>查看帮助：apt help
</span></span><span style=display:flex><span>**apt与apt-get命令对比**
</span></span><span style=display:flex><span>| apt命令         | 被取代的命令       | 命令的功能               |
</span></span><span style=display:flex><span>|-----------------|-------------------|------------------------|
</span></span><span style=display:flex><span>| apt install     | apt-get install   | 安装软件包               |
</span></span><span style=display:flex><span>| apt remove      | apt-get remove    | 移除软件包               |
</span></span><span style=display:flex><span>| apt purge       | apt-get purge     | 移除软件包及配置文件     |
</span></span><span style=display:flex><span>| apt update      | apt-get update    | 刷新存储库索引           |
</span></span><span style=display:flex><span>| apt upgrade     | apt-get upgrade   | 升级所有可升级的软件包   |
</span></span><span style=display:flex><span>| apt autoremove  | apt-get autoremove| 自动删除不需要的包       |
</span></span><span style=display:flex><span>| apt full-upgrade| apt-get dist-upgrade| 在升级软件包时自动处理依赖关系 |
</span></span><span style=display:flex><span>| apt search      | apt-cache search  | 搜索应用程序             |
</span></span><span style=display:flex><span>| apt show        | apt-cache show    | 显示安装细节             |
</span></span><span style=display:flex><span>apt 特有的命令
</span></span></code></pre></div><p>apt list 列出包含条件的包（已安装，可升级等）
apt edit-sources 编辑源列表</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>APT包索引配置文件
</span></span></code></pre></div><p>/etc/apt/sources.list
/etc/apt/sources.list.d</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>可以修改上面文件为国内的安装源，提高速度
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>参考链接[https://developer.aliyun.com/mirror/ubuntu?spm=a2c6h.13651102.0.0.53322f70fghx56](https://developer.aliyun.com/mirror/ubuntu?spm=a2c6h.13651102.0.0.53322f70fghx56)
</span></span><span style=display:flex><span>范例: 修改阿里云的APT源为清华源  
</span></span></code></pre></div><p>root@ubuntu2004:~# sed -i &rsquo;s/mirrors.aliyun.com/mirrors.tuna.tsinghua.edu.cn/&rsquo;
/etc/apt/sources.list</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例: 修改APT源为清华源
</span></span><span style=display:flex><span>https://mirrors.tuna.tsinghua.edu.cn/  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>![image](https://github.com/user-attachments/assets/c85f3227-956d-4ac5-8474-70eb719df1c9)
</span></span><span style=display:flex><span>![image](https://github.com/user-attachments/assets/4d230226-6eee-439e-b01b-8c7d1807a95e)
</span></span><span style=display:flex><span>apt命令操作（如安装和删除软件包）日志文件
</span></span></code></pre></div><p>/var/log/dpkg.log</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例：
</span></span></code></pre></div><p>#安装包：
apt install tree zip</p><p>#安装deb包,注意:包文件前必须加路径
apt install ./mongodb-database-tools-ubuntu1804-x86_64-100.5.1.deb</p><p>#安装图形桌面
apt install ubuntu-desktop</p><p>#删除包：
apt remove tree zip
#说明：apt remove中添加&ndash;purge选项会删除包配置文件，谨慎使用
#更新包索引，相当于yum clean all;yum makecache
apt update
#升级包：要升级系统，请首先更新软件包索引，再升级
apt upgrade</p><p>#apt列出仓库软件包，等于yum list
apt list
#搜索安装包
apt search nginx
#查看某个安装包的详细信息
apt show apache2</p><p>#在线安装软件包
apt install apache2</p><p>#卸载单个软件包但是保留配置⽂件
apt remove apache2</p><p>#删除安装包并解决依赖关系
apt autoremove apache2</p><p>#更新本地软件包列表索引，修改了apt仓库后必须执⾏
apt update</p><p>#卸载单个软件包删除配置⽂件
apt purge apache2</p><p>#升级所有已安装且可升级到新版本的软件包
apt upgrade</p><p>#升级整个系统，必要时可以移除旧软件包。
apt full-upgrade</p><p>#编辑source源⽂件
apt edit-sources</p><p>#查看仓库中软件包有哪些版本可以安装
apt-cache madison nginx</p><p>#安装软件包的时候指定安装具体的版本
apt install nginx=1.14.0-0ubuntu1.6</p><p>#查看文件来自于哪个包,类似redhat中的yum provides <filename>apt-file search &lsquo;string&rsquo; #默认是包含此字符串的文件
apt-file search -x &lsquo;正则表达式&rsquo;
apt-file search -F /path/file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>### 软件管理案例
</span></span><span style=display:flex><span>#### 案例1: 查看文件来自于哪个包
</span></span><span style=display:flex><span>范例: 查找存在的文件来自于哪个包
</span></span></code></pre></div><p>#dpkg -S filename ：在当前安装的包里查找文件
[root@ubuntu1804 ~]#dpkg -S /bin/ls
coreutils: /bin/ls</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>范例: 查找不存在的文件存在于哪个包
</span></span></code></pre></div><p>[root@ubuntu1804 ~]#apt -y install apt-file
[root@ubuntu1804 ~]#apt update
[root@ubuntu1804 ~]#apt-file search -x &lsquo;/sl$&rsquo;
espeak-data: /usr/lib/x86_64-linux-gnu/espeak-data/voices/test/sl
espeak-ng-data: /usr/lib/x86_64-linux-gnu/espeak-ng-data/lang/zls/sl
language-pack-sl-base: /var/lib/locales/supported.d/sl
python-langdetect: /usr/lib/python2.7/dist-packages/langdetect/profiles/sl
python3-langdetect: /usr/lib/python3/dist-packages/langdetect/profiles/sl
qemu-system-common: /usr/share/qemu/keymaps/sl
rdesktop: /usr/share/rdesktop/keymaps/sl
sl: /usr/games/sl
virtualbox: /usr/share/virtualbox/rdesktop-vrdp-keymaps/sl</p><p>[root@ubuntu1804 ~]#apt-file search -F /usr/games/sl
sl: /usr/games/sl</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 案例2: 查看包相关信息
</span></span></code></pre></div><p>#显示系统安装包的统计信息,可以统计已经安装包的数量，大小，占用空间等
#apt-cache stats
[root@ubuntu1804 ~]#apt-cache stats
Total package names: 84873 (1,697 k)
Total package structures: 126998 (5,588 k)
Normal packages: 91623
Pure virtual packages: 2648
Single virtual packages: 10275
Mixed virtual packages: 5110</p><p>&mldr;.</p><p>#显示xxx包的信息,可以看到某个包的源、版本等信息
#apt-cache show xxx #更详细
#apt show xxx</p><p>[root@ubuntu1804 ~]#apt show keepalived
Package: keepalived
Version: 1:1.3.9-1ubuntu0.18.04.2
Priority: optional
Section: admin
Origin: Ubuntu
Maintainer: Ubuntu Developers
<a href=mailto:ubuntu-devel-discuss@lists.ubuntu.com title=ubuntu-devel-discuss@lists.ubuntu.com>ubuntu-devel-discuss@lists.ubuntu.com</a></p><p>&mldr;.</p><p>[root@ubuntu1804 ~]#apt-cache show keepalived</p><p>&mldr;.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 案例3: 查看仓库中的指定软件的所有版本
</span></span></code></pre></div><p>[root@ubuntu1804 ~]#apt-cache madison docker-ce
docker-ce | 5:19.03.13~3-0~ubuntu-bionic |
<a href=https://mirrors.aliyun.com/docker- title=https://mirrors.aliyun.com/docker- rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.aliyun.com/docker-
<i class="fa fa-external-link-alt"></i>
</a>ce/linux/ubuntu bionic/stable amd64 Packages
docker-ce | 5:19.03.12~3-0~ubuntu-bionic |
<a href=https://mirrors.aliyun.com/docker- title=https://mirrors.aliyun.com/docker- rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.aliyun.com/docker-
<i class="fa fa-external-link-alt"></i>
</a>ce/linux/ubuntu bionic/stable amd64 Packages
docker-ce | 5:19.03.11~3-0~ubuntu-bionic |
<a href=https://mirrors.aliyun.com/docker- title=https://mirrors.aliyun.com/docker- rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.aliyun.com/docker-
<i class="fa fa-external-link-alt"></i>
</a>ce/linux/ubuntu bionic/stable amd64 Packages
docker-ce | 5:19.03.10~3-0~ubuntu-bionic |
<a href=https://mirrors.aliyun.com/docker- title=https://mirrors.aliyun.com/docker- rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mirrors.aliyun.com/docker-
<i class="fa fa-external-link-alt"></i>
</a>ce/linux/ubuntu bionic/stable amd64 Packages</p><p>#安装指定版本
[root@ubuntu1804 ~]#apt -y install docker-ce=5:19.03.13~3-0~ubuntu-bionic</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 案例4: 查看文件的依赖
</span></span></code></pre></div><p>#查询软件xxx依赖哪些包
#apt depends xxx
#apt-cache depends xxx</p><p>[root@ubuntu1804 ~]#apt depends keepalived
keepalived
Depends: iproute2
iproute2:i386
Depends: libc6 (>= 2.27)
Depends: libglib2.0-0 (>= 2.26.0)
Depends: libip4tc0 (>= 1.6.0+snapshot20161117)</p><p>&mldr;.</p><p>#查询软件xxx被哪些包依赖
#apt rdepends xxx
#apt-cache rdepends xxx</p><p>[root@ubuntu1804 ~]#apt rdepends bash
bash
Reverse Depends:
Depends: bash-builtins (= 4.4.18-2ubuntu1.2)
bash:i386
Recommends: plasma-sdk (>= 4.3)
bash:i386</p><p>&mldr;.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 案例5: 安装桌面
</span></span></code></pre></div><p>[root@ubuntu1804 ~]#apt install ubuntu-desktop -y
[root@ubuntu1804 ~]#init 5</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### ubuntu 建议安装的常用包
</span></span></code></pre></div><p>[root@ubuntu1804 ~]#apt purge ufw lxd lxd-client lxcfs liblxc-common
[root@ubuntu1804 ~]#apt install iproute2 ntpdate tcpdump telnet traceroute nfs-
kernel-server nfs-common lrzsz tree openssl libssl-dev libpcre3 libpcre3-dev
zlib1g-dev gcc openssh-server iotop unzip zip</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>#### 练习
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>1、查询命令java来自于哪个rpm包  
</span></span><span style=display:flex><span>2、yum的配置和使用,包括yum仓库的创建  
</span></span><span style=display:flex><span>3、编写系统初始化脚本 reset.sh，包括别名，提示符颜色，yum仓库配置文件,安装tree,ftp,lftp,telnet
</span></span><span style=display:flex><span>等包  
</span></span><span style=display:flex><span>4、在CentOS 8上编译安装 apache 2.4.43 源码包,并启动此服务  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>## 总结
</span></span><span style=display:flex><span>![](/images/url/linux/linux09/11.jpg)
</span></span></code></pre></div></div><footer class=post-footer><div class=post-tags><a href=/tags/linux>linux</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/_ali-pay.png alt="蓝惠の小窝 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/_wechat-pay.png alt="蓝惠の小窝 - 微信">
<span>微信</span></div></div></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/rss.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/linux13/ rel=next title="网络基础 "><i class="fa fa-chevron-left"></i> 网络基础</a></div><div class="post-nav-prev post-nav-item"><a href=/post/linux11/ rel=prev title=磁盘存储和文件系统>磁盘存储和文件系统
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2019 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>蓝惠の小窝</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.126.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>湘ICP备20000440号</a>
<img src=/imgs/gongan.png alt=湘公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402019770" target=_blank>湘公网安备 31011402019770 号</a></div><div class=vendors-list><a target=_blank href title><img src=/imgs/img-lazy-loading.gif data-src alt>
</a><a target=_blank href title><img src=/imgs/img-lazy-loading.gif data-src alt>
</a><a target=_blank href title></a><span></span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#0cd2f8","enable":true,"save":"manual"},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Announcements","categoryid":"DIC_kwDOL_1gUs4Cfkpa","emit":"url","inputposition":"top","mapping":"top","reactions":true,"repo":"lanhui672/lanhui672.Giscus","repoid":"R_kgDOL_1gUg","theme":"cobalt\n\nlang=\"zh-CN\""},"js":"https://giscus.app/client.js"},"hostname":"http://localhost:1313/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":false,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"right","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3"}</script><script type=text/javascript src=/js/main.js defer></script></body></html>